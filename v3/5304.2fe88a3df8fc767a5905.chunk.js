!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f05bb4e6-3f2b-4c2a-9373-df2680fa8553",e._sentryDebugIdIdentifier="sentry-dbid-f05bb4e6-3f2b-4c2a-9373-df2680fa8553")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"c87aa722cb3cb6eb3ac10b8f2032443089be80ba"},(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[5304],{57013:(e,t,a)=>{a.d(t,{A:()=>u,H:()=>d});a(41393),a(81454);var l=a(96540),n=a(47444),r=a(3914),s=a(67990),o=a(63129),c=a(88982);const i=()=>{const e=(0,r.vt)();return(0,n.Zs)((t=>{let{set:a,snapshot:l}=t;return async t=>{const n=await l.getPromise((0,s.$6)({id:t,key:"nodes"}));let r=null;return n?.length||(a((0,s.$6)({id:t,key:"loaded"}),!1),r=(0,o.uQ)({roomId:t,spaceId:e}),r.then((e=>{let{data:l}=e;a((0,s.$6)({id:t,key:"nodes"}),l.map((e=>{let{id:t,name:a}=e;return{label:a,value:t}}))),a((0,s.$6)({id:t,key:"loaded"}),!0)})).catch((e=>a((0,s.$6)({id:t,key:"error"}),e)))),r}}),[e])},d=()=>{const e=i(),t=(0,c.n)("id");(0,l.useEffect)((()=>{let a=null;return t&&(a=e(t)),()=>!!a?.cancel&&a.cancel()}),[t,e])},u=i},25304:(e,t,a)=>{a.r(t),a.d(t,{default:()=>le});var l=a(96540),n=a(83084),r=a(28738),s=(a(8159),a(98992),a(37550),a(87659)),o=a(81638),c=a(30577),i=a(93615),d=a(58168),u=a(65336),m=(a(9920),a(14905),a(3949),a(8872),a(27467)),g=a(59846),b=a(82700),p=a(37171),y=a(10368);const h=(e,t,a)=>{let{id:l,name:n}=e;-1==a?t.push({id:l,name:n,count:1}):t[a]={...t[a],count:t[a].count+1}},f=e=>e.id,E=e=>e.name,x=e=>{let{title:t,baseKey:a,param:n,paramKey:r,extraKey:s,testIdPrefix:o}=e;const c=(e=>{let{baseKey:t,extraKey:a,param:n,paramKey:r}=e;const{rules:s}=(0,p.q)({extraKey:a,omit:n,keepAll:!0}),o=(0,m.rW)(n,{key:t,extraKey:a,flavour:"arr"});return(0,l.useMemo)((()=>s.reduce(((e,t)=>{const a=t[r];if(!a)return e;const l=e.findIndex((e=>e.id==a.id));return"id"==r?h({id:a,name:a},e,l):["rooms","nodes"].includes(r)?a.forEach((t=>{let{id:a,name:n,notAvailable:r}=t;h({id:a,name:r?`Not available (${a})`:n},e,l)})):["alertNames","alertContexts","alertRoles"].includes(r)?a.forEach((t=>{h({id:t,name:t},e,l)})):"hostLabels"==r&&Object.entries(a).forEach((t=>{let[a,n]=t;const r=(0,y.M)({key:a,value:n});h({id:r,name:r},e,l)})),e}),[])),[s,o])})({baseKey:a,extraKey:s,param:n,paramKey:r});return c.length?l.createElement(g.A,{title:t,testIdPrefix:o,param:n,baseKey:a,extraKey:s},l.createElement(b.Ay,{param:n,baseKey:a,extraKey:s,testIdPrefix:o,collection:c,getValue:f,getLabel:E,capitalized:!1})):null};var A=a(3914),v=a(78940);const w=[{title:"Rules IDs",param:"ids",paramKey:"id"},{title:"Rooms",param:"roomIds",paramKey:"rooms"},{title:"Nodes",param:"nodeIds",paramKey:"nodes"},{title:"Host labels",param:"hostLabels",paramKey:"hostLabels"},{title:"Alert names",param:"alertNames",paramKey:"alertNames"},{title:"Alert contexts",param:"alertContexts",paramKey:"alertContexts"},{title:"Alert roles",param:"alertRoles",paramKey:"alertRoles"}],k={filters:{iconName:"filterList",color:{active:"success",notActive:"textLite"},width:"19px",Content:(0,l.memo)((e=>{const t=(0,A.vt)();return l.createElement(u.Flex,(0,d.A)({column:!0,height:"calc(100vh - 266px)",overflow:{vertical:"auto"},padding:[0,0,30]},e),w.map((e=>{let{title:a,param:n,paramKey:r}=e;return l.createElement(x,{key:a,baseKey:t,extraKey:v.qt,title:a,param:n,paramKey:r})})))})),dataTestId:"filterBar",label:"Filters"}},K=["filters"],S=e=>e.some((e=>{let{roomIds:t=[],nodeIds:a=[],hostLabels:l={},alertNames:n=[],alertContexts:r=[],alertRoles:s=[]}=e;return t.length||a.length||Object.keys(l).length||n.length||r.length||s.length})),C=e=>{let{rules:t}=e;const[a,n]=(0,s.A)((()=>S(t))),{Content:r}=k.filters;return(0,l.useEffect)((()=>{n(S(t))}),[t]),l.createElement(o.Ay,{collapsedComponent:l.createElement(c.A,{onClickTab:n,availableTabs:k,tabsToShow:K}),isOpen:a,header:l.createElement(i.A,{isOpen:a,onToggle:n,title:"Filters",icon:"filterList"})},l.createElement(r,{padding:[0,3,30]}))};var T=a(39225),I=a(4659),L=a(65570),F=(a(41393),a(81454),a(21290)),R=a(36021),D=a(71835),N=a(29217),M=a(40267);const P=e=>{let{value:t,...a}=e;return l.createElement(N.A,{content:t},l.createElement(u.Pill,(0,d.A)({flavour:"neutral"},a),t))},$=()=>l.createElement(u.Text,null,"*"),_=e=>{let{getValue:t}=e;const a=t();return a?.length?l.createElement(u.Flex,{flexWrap:!0,gap:1},a.map((e=>l.createElement(u.Flex,{key:e,padding:[.5,0]},l.createElement(P,{value:e}))))):l.createElement($,null)},j=e=>{let{getValue:t}=e;const{localeDateString:a}=(0,F.$j)();if(!t())return l.createElement(u.Text,null,"-");const n=a(new Date(t()),{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",long:!1,dateStyle:void 0});return l.createElement(u.Text,{whiteSpace:"nowrap"},n)},O=[{id:"disabled",name:"Disable rule",accessorKey:"disabled",header:"",cell:e=>{let{row:t,getValue:a}=e;const n=t.original,[r,o]=(0,l.useState)(!a()),[c,i]=(0,s.A)(),[,d]=(0,D.A)(),m=(0,R.FU)(),g=(0,R.Lz)();return l.createElement(u.Toggle,{colored:!0,checked:r,disabled:c,onChange:e=>{i();const t=e.target.checked;o(t),m({...n,disabled:!t}).then((()=>{g()})).catch((e=>{o(!t),d(e)})).finally(i)}})},size:80},{id:"name",name:"Name",accessorKey:"name",header:"Rule name",cell:e=>{let{row:t,getValue:a}=e;const{accountId:n}=t.original;return l.createElement(u.Flex,{gap:2,alignItems:"center"},l.createElement(u.Text,{wordBreak:"break-word"},a()),n&&l.createElement(N.A,{align:"bottom",content:"This rule affects only your account"},l.createElement(u.Box,null,l.createElement(u.Icon,{color:"textLite",height:"16px",name:"userPress",width:"16px"}))))}},{id:"rooms",name:"Rooms",accessorKey:"rooms",header:"Rooms",cell:e=>{let{getValue:t}=e;const a=t();return a?.length?l.createElement(u.Text,null,a.map((e=>{let{name:t}=e;return t})).join(", ")):l.createElement(u.Text,null,"All rooms")}},{id:"nodes",name:"Nodes",accessorKey:"nodes",header:"Nodes",cell:e=>{let{getValue:t}=e;const a=t();return a?.length?l.createElement(u.Flex,{flexWrap:!0,gap:1},a.map((e=>{let{id:t,name:a,notAvailable:n}=e;const r=n?l.createElement(u.Flex,{alignItems:"center",gap:1},l.createElement(u.Icon,{name:"warning_triangle",size:"small",color:"neutralPillColor"}),l.createElement(u.Text,null,"Node no longer available")):a;return l.createElement(P,{key:t,value:r})}))):l.createElement($,null)}},{id:"hostLabels",name:"Host labels",accessorKey:"hostLabels",header:"Host labels",cell:e=>{let{getValue:t}=e;const a=t(),n=Object.entries(a||{});return n.length?l.createElement(u.Flex,{flexWrap:!0,gap:1},n.map((e=>{let[t,a]=e;const n=(0,y.M)({key:t,value:a});return l.createElement(P,{key:n,value:n})}))):l.createElement($,null)}},{id:"alertNames",name:"Alert names",accessorKey:"alertNames",header:"Alert name",cell:_},{id:"alertContexts",name:"Alert contexts",accessorKey:"alertContexts",header:"Alert context",cell:_},{id:"alertInstances",name:"Alert instances",accessorKey:"alertInstances",header:"Alert instances",cell:_},{id:"severities",name:"Alert status",accessorKey:"severities",header:"Alert status",cell:e=>{let{getValue:t}=e;const a=t();return a?.length?l.createElement(u.Flex,{flexWrap:!0,gap:1},a.map((e=>l.createElement(u.Flex,{key:e,padding:[.5,0]},l.createElement(M.A,{flavour:e.toLowerCase()},e))))):l.createElement($,null)}},{id:"alertRoles",name:"Alert roles",accessorKey:"alertRoles",header:"Alert role",cell:_},{id:"startDate",name:"Start date",accessorKey:"startsAt",header:"Start date",cell:j},{id:"endDate",name:"End date",accessorKey:"lastsUntil",header:"End date",cell:j}];var V=a(38819),H=a(29848),U=a(46741);const z={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",long:!1,dateStyle:void 0},B=()=>{const[e,t]=(0,l.useState)(""),{silencingRulePrefill:a}=(0,V.PP)(),n=a?{type:"create"}:{},[r,s]=(0,l.useState)(n),[,o]=(0,D.A)(),{localeDateString:c}=(0,F.$j)(),i=(0,R._S)(),d=(0,R.Lz)(),m=(0,H.ly)(),g=()=>s({type:"create"}),b=e=>s({type:"edit",rule:e}),p=e=>{let{id:t}=e;i([t]).then((()=>{d(),m()})).catch(o)},y=(0,U.JT)("space:DeletePersonalSilencingRule"),h=(0,U.JT)("space:DeleteSystemSilencingRule"),f=(0,l.useMemo)((()=>({addEntry:{dataGa:"",flavour:"hollow",handleAction:g,iconColor:"success",label:"Add rule",small:!0,width:"auto"}})),[]),E=e=>{let{name:t}=e;return l.createElement(l.Fragment,null,"Delete ",t," rule")};return{search:e,setSearch:t,bulkActions:f,rowActions:(0,l.useMemo)((()=>({edit:{handleAction:b,disabledTooltipText:"Edit is disabled",isDisabled:e=>{let{readOnly:t}=e;return!!t},dataGa:"alert-silencing::click-edit-row::rules-table"},delete:{handleAction:p,confirmationTitle:E,confirmationMessage:e=>l.createElement(u.Text,{wordBreak:"break-word"},"You are about to delete ",l.createElement("strong",null,e.name)," silencing rule.",l.createElement("br",null),"Are you sure you want to continue?"),dataGa:"alert-silencing::click-delete-row::rules-table",disabledTooltipText:"Delete is disabled",confirmLabel:"Yes, delete",declineLabel:"Cancel",isDisabled:e=>{let{accountId:t}=e;return t?!y:!h}}})),[]),onFilter:(0,l.useCallback)(((e,t,a)=>{const l=e.original,n=a.toLowerCase(),r=(l.rooms||[]).map((e=>{let{name:t}=e;return t})),s=(l.nodes||[]).map((e=>{let{name:t}=e;return t})),o=l.alertNames||[],i=l.alertContexts||[],d=l.severities||[],u=l.alertRoles||[],m=l.hostLabels||{},g=l.startsAt?c(new Date(l.startsAt),z):"",b=l.lastsUntil?c(new Date(l.lastsUntil),z):"";return((e,t)=>e.some((e=>e.toLowerCase().includes(t))))([l.name.toLowerCase(),...r,...s,...o,...i,...d,...u,...Object.entries(m).flat(),g,b],n)}),[]),modalDetails:r,closeModal:()=>s({})}},W=(0,T.A)((()=>a.e(916).then(a.bind(a,70916))),"CreateOrUpdateRuleModal"),q=(0,l.memo)(u.Table,((e,t)=>(0,L.Ay)(e,t))),J={right:["actions"]},G=()=>l.createElement(u.Flex,null,l.createElement(u.Text,null,"Create or Maintain Alert Notification Silencing Rules on this Space. These rules can be applicable to all users or just you, depending on their definition."," ",l.createElement(I.A,{"data-ga":"alert-silencing::click-link-docs::rules-table","data-testid":"silencing-rules-doc",href:"https://learn.netdata.cloud/docs/alerts-and-notifications/notifications/netdata-cloud-notifications/#silencing-alert-notifications",rel:"noopener noreferrer",target:"_blank"},"Read the Alert Notification Silencing Rules documentation to learn more."))),Y=e=>{let{data:t}=e;const{search:a,setSearch:n,bulkActions:r,rowActions:s,onFilter:o,modalDetails:c,closeModal:i}=B();return l.createElement(l.Fragment,null,l.createElement(u.Flex,{column:!0,gap:4,padding:[2,4],height:"calc(100vh - 241px)"},l.createElement(G,null),l.createElement(q,{key:JSON.stringify(t||{}),enableSorting:!0,enableColumnVisibility:!0,data:t,dataColumns:O,bulkActions:r,rowActions:s,globalFilter:a,globalFilterFn:o,onSearch:n,columnPinning:J,enableColumnPinning:!0})),"create"==c.type?l.createElement(l.Suspense,null,l.createElement(W,{onClose:i})):null,"edit"==c.type&&c.rule?l.createElement(l.Suspense,null,l.createElement(W,{rule:c.rule,onClose:i,isEdit:!0})):null)};var Q=a(9415),Z=a(89821),X=a(18061);const ee=e=>{let{errorMessage:t}=e;return l.createElement(u.Flex,{column:!0,gap:2,alignItems:"center",justifyContent:"center",flex:!0},l.createElement(u.TextBig,null,"Something went wrong"),t&&l.createElement(u.Text,null,"(",t,")"))};var te=a(57013),ae=a(63314);const le=()=>{(e=>{const t=(0,R.ys)({id:e,key:"initialLoad"}),a=(0,R.Qu)(),l=(0,R.UJ)(e);(0,X.A)((()=>({enabled:!!e&&!t,fetch:()=>(0,Q.cH)(e),onFail:e=>l({...Z.$,loading:!1,loaded:!0,error:e}),onSuccess:e=>l(((e,t)=>({...e,loading:!1,loaded:!0,initialLoad:!0,rules:t}))(Z.$,e))})),[e,a])})((0,A.vt)()),(0,te.H)();const{loaded:e,rules:t,error:a}=(0,p.q)({extraKey:v.qt});return e?a?l.createElement(ae.DL,{tab:"Notifications::SilencingRules"},l.createElement(ee,{errorMessage:a.message})):l.createElement(ae.Ay,{tab:"Notifications::SilencingRules"},l.createElement(n.A,{sidebar:l.createElement(C,{rules:t}),margin:[3,0]},l.createElement(Y,{data:t}))):l.createElement(r.A,{height:"calc(100% - 44px)",title:"Loading silencing rules..."})}},10368:(e,t,a)=>{a.d(t,{H:()=>n,M:()=>r});a(14905),a(98992),a(8872);var l=a(78940);const n=e=>{const{validationErrors:t,errorMessage:a}=e?.response?.data||{};return t&&Object.keys(t).length?Object.entries(t).reduce(((e,t)=>{let[,a]=t;const{code:n,message:r}=a;return l.xc[n]||r?e.push({errorMessage:l.xc[n]||r}):e.includes(l.xc.default)||e.push({errorMessage:l.xc.default}),e}),[]):[{errorMessage:a}]},r=e=>{let{key:t,value:a}=e;return`${t}: ${a}`}}}]);