!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="dfe1da47-5b13-4c76-a295-ac768921642f",e._sentryDebugIdIdentifier="sentry-dbid-dfe1da47-5b13-4c76-a295-ac768921642f")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"c87aa722cb3cb6eb3ac10b8f2032443089be80ba"},(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[6323],{49032:(e,t,a)=>{a.d(t,{B9:()=>l});const n=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,l=e=>!!e&&n.test(e)},84707:(e,t,a)=>{a.d(t,{y:()=>c});a(17333),a(41393),a(98992),a(54520),a(81454);var n=a(96540),l=a(65336),i=a(49032);const s=(0,a(8711).default)(l.Select).withConfig({displayName:"styled__StyledSelect",componentId:"sc-bkkrx-0"})(["width:100%;"]);a(71517),a(11379),a(93777),a(14190),a(12359),a(86097),a(17273),a(27415),a(19929),a(37583),a(55122),a(20230),a(57268),a(79733),a(25509),a(65223),a(60321),a(41927),a(11632),a(64377),a(66771),a(12516),a(68931),a(52514),a(35694),a(52774),a(49536),a(21926),a(94483),a(16215);const o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name";return e.length?"string"===typeof e[0]?[...new Set(e)]:[...new Map(e.map((e=>[e[t],e]))).values()]:[]},r=[],c=e=>{let{invitations:t,setInvitations:a}=e;const[c,d]=(0,n.useState)(r),[m,u]=(0,n.useState)(""),[p,v]=(0,n.useState)(""),g=()=>v(""),h=(0,n.useCallback)((e=>{u(e.toLowerCase())}),[u]),f=n.useCallback((e=>{let{emails:t=r,invitations:n=r,isEmailValid:l}=e;if(l){const e=o(t),l=o(n);return d(e),a(l),u(""),void g()}v("Invalid Email")}),[a]),b=(0,n.useCallback)((e=>(0,i.B9)(e)&&!c.includes(e)),[c]),y=(0,n.useCallback)((e=>{f({isEmailValid:!0,emails:e.map((e=>e.value)),invitations:e.map((e=>({email:e.value,name:e.value.split("@")[0]})))})}),[d]),E=(0,n.useCallback)((e=>{const a=e.clipboardData.getData("Text").toLowerCase().replace(/ /g,",").replace(/,,/g,",").split(",").filter((e=>b(e)))||r;f({emails:[...c,...a],invitations:[...t,...a.map((e=>({email:e,name:e.split("@")[0]})))],isEmailValid:a.length>0}),e.preventDefault()}),[c,t,b,f]),w=(0,n.useCallback)((e=>{if(m)switch(g(),e.key){case"Enter":case"Tab":case",":case" ":f({emails:[...c,m],invitations:[...t,{email:m,name:m.split("@")[0]}],isEmailValid:b(m)}),e.preventDefault()}}),[c,m,t,b,f]);return n.createElement(l.Flex,{justifyContent:"space-between",column:!0,onPaste:E},n.createElement(s,{components:{DropdownIndicator:null},inputValue:m,isClearable:!0,isMulti:!0,menuIsOpen:!1,onBlur:()=>{m&&f({emails:[...c,m],invitations:[...t,{email:m,name:m.split("@")[0]}],isEmailValid:b(m)})},onChange:y,onInputChange:h,onKeyDown:w,onClear:()=>{d(r),a(r)},placeholder:"Enter an email and hit enter",value:c.map((e=>{return{label:t=e,value:t};var t}))}),p&&n.createElement(l.Text,{color:"error"},p))}},6323:(e,t,a)=>{a.d(t,{d:()=>B});var n=a(58168),l=(a(17333),a(41393),a(98992),a(54520),a(81454),a(96540)),i=a(65336),s=a(71847),o=a(13871),r=a(78217),c=a(83179),d=a(4659),m=a(84707),u=a(3914),p=a(14994),v=a(77181),g=a(81048),h=a(15327),f=a(74618),b=a(45765),y=a(27287);const E=e=>{let{id:t,handleDelete:a}=e;const n=(0,v.c)(t,"email");return l.createElement(i.Flex,{justifyContent:"between",alignItems:"center"},l.createElement(i.Flex,{gap:4},l.createElement(i.Icon,{color:"text",name:"check"}),l.createElement(i.Text,null,n)),l.createElement(i.Button,{flavour:"borderless",icon:"trashcan",onClick:()=>a({email:n})}))};var w=a(71835),C=a(49032),k=a(46741),I=a(66269),x=a(36850),S=a(92155),_=a(50876),A=a(63314);const R=e=>{let{email:t}=e;return(0,C.B9)(t)},T=(0,S.A)(i.Button),U={header:"Invitations",text:"Invitations successfully sent!"},B=e=>{let{onClose:t,isSubmodal:a=!1}=e;const{id:C,name:S,slug:B}=(0,u.ap)(),$=(0,p.WW)(),[j,D]=(0,l.useState)($),[L,N]=(0,l.useState)([]),[F,V]=(0,l.useState)([]),[z,M]=(0,l.useState)(),{sendLog:Z,isReady:O}=(0,_.A)(),[H,K,P,Y]=(0,v.g)(C),[,G]=(0,w.A)(),q=(0,l.useCallback)((e=>{const{header:a,text:n}=e||U,l=(0,o.UI)({header:a,text:n,success:!0}),i=F.filter(R).map((e=>{let{email:t}=e;return t})).join(",");(0,s.H)("invite","invite-sent",`${z}::${i}::${j.join(",")}`,"","","invite-sent"),r.A.success(l,{context:"manageInvitations"}),t(),O&&Z({isSuccess:!0},!0)}),[Z,O]),Q=(0,k._s)(),W=e=>t=>{let{email:a}=t;e&&K(e),V(F.filter((e=>e.email!==a))),N(L.filter((e=>e.email!==a)))},J=(0,l.useCallback)((()=>{D([])}),[D]),X="member"===z;return l.createElement(h.GO,{onClose:t,closeOnClickOutside:!1},l.createElement(A.Ay,{feature:"ManageInvitationsModal"},l.createElement(f.z,{onClose:t,isSubmodal:a,title:"Invite Users"}),l.createElement(b.U,null,"Invite users to\xa0",S),l.createElement(h.Yv,null,l.createElement(y.dE,null,"Send invitations to your team"),l.createElement(y.BZ,null,"TIP: You can send more invitations at once, separate each with a comma."),l.createElement(m.y,{invitations:F,setInvitations:V}),l.createElement("br",null),l.createElement(y.dE,null,"Rooms"),l.createElement(i.Flex,{alignItems:"center",justifyContent:"between",margin:[1,0,2]},l.createElement(i.TextSmall,null,"Choose one or more rooms you'd like to invite users to."),!!j.length&&l.createElement(i.Button,{onClick:J,padding:[0],flavour:"borderless","data-ga":"rooms-clear",label:"Clear",small:!0},"Clear")),l.createElement(i.Box,{"data-testid":"invite-selectRoom"},l.createElement(c.A,(0,n.A)({selectedValue:j,onChange:D},X?{formatOptions:e=>{let{name:t}=e;return{isDisabled:t===g.Q8}},filterValues:e=>{let{label:t}=e;return t===g.Q8}}:{}))),l.createElement("br",null),l.createElement(y.dE,null,"Role"),l.createElement(y.BZ,null,"Choose a role for invited user."," ",l.createElement(d.A,{href:x.S,target:"_blank",rel:"noopener noreferrer",Component:i.TextSmall},"Learn more")),l.createElement(i.Box,{"data-testid":"invite-selectRole"},l.createElement(I.A,{availableRoles:Q,dataGA:"invite-to-space",dataTestId:"invite-selectRole",onChange:e=>{M(e.target.value)},value:z})),l.createElement(y.fh,null,l.createElement(T,{label:"Send",onClick:async()=>{const e=F.filter(R).map((e=>({email:e.email,name:e.name,role:z,roomIDs:j}))),t=`${window.location.origin}/spaces/${B}/join-space`;P(e,t,{onSuccess:q,onError:e=>{G(e),Z({isFailure:!0,error:e.message},!0)}})},disabled:0===F.length||!z,flavour:"hollow",isLoading:Y,"data-ga":"manage-invitations-modal::click-send::modal-footer"})),l.createElement(i.H5,{margin:[2,0,0]},"Invitations awaiting response"),l.createElement(i.Flex,{column:!0},H.length>0?H.map((e=>l.createElement(E,{key:e,handleDelete:W(e),id:e}))):l.createElement(y.au,null,l.createElement("br",null),l.createElement(y.dE,null,"You haven't invited any users yet."))))))}},27287:(e,t,a)=>{a.d(t,{BZ:()=>r,au:()=>o,dE:()=>i,fh:()=>s});var n=a(8711),l=a(65336);const i=(0,n.default)(l.H5).withConfig({displayName:"styled__StyledH5",componentId:"sc-1kusjmi-0"})(["display:flex;align-items:center;"]),s=n.default.div.withConfig({displayName:"styled__FormRow",componentId:"sc-1kusjmi-1"})(["width:100%;display:flex;flex-flow:row no-wrap;justify-content:flex-end;margin-top:",";"],(0,l.getSizeBy)(2)),o=n.default.div.withConfig({displayName:"styled__StyledUserInvitationEmptyListItem",componentId:"sc-1kusjmi-2"})(["display:flex;flex-flow:column nowrap;align-items:center;"]),r=(0,n.default)(l.TextSmall).withConfig({displayName:"styled__StyledSecondaryText",componentId:"sc-1kusjmi-3"})(["margin:2px 0 8px;"])},65923:(e,t,a)=>{a.d(t,{R:()=>o,H:()=>r});var n=a(47444);const l=(0,n.eU)({key:"celloSuccessfulInitialization",default:!1}),i=(0,n.eU)({key:"celloLauncherActive",default:!1});var s=a(96540);const o=()=>{const[e,t]=(0,n.L4)(l);return{isInitialized:e,init:(0,s.useCallback)((()=>t(!0)),[t])}},r=()=>{const[e,t]=(0,n.L4)(i);return{isActive:e,activate:(0,s.useCallback)((()=>t(!0)),[t]),deactivate:(0,s.useCallback)((()=>t(!1)),[t])}}},66269:(e,t,a)=>{a.d(t,{A:()=>g});a(41393),a(81454);var n=a(96540),l=a(65336),i=a(8711),s=a(80158),o=a(97674),r=a(3914),c=a(4659),d=a(84976),m=a(46741),u=a(27994);const p={admin:"Users with this role can control Spaces, Rooms, Nodes, Users and Billing. They can also access any Room in the Space.",member:"Users with this role can create Rooms and invite other Members. They can only see the Rooms they belong to and all Nodes in the All Nodes room",manager:"Users with this role can manage Rooms and Users. They can access any Room in the Space.",troubleshooter:"Users with this role can use Netdata to troubleshoot, not manage entities. They can access any Room in the Space.",observer:"Users with this role can only view data in specific Rooms.",billing:"Users with this role can handle billing options and invoices."},v=(0,i.default)(l.Flex).withConfig({displayName:"rolePicker__PlanBadge",componentId:"sc-szt8jq-0"})(["pointer-events:auto;"]),g=e=>{let{availableRoles:t,dataGA:a,dataTestId:i,onChange:g,value:h}=e;const f=(0,r.ap)("plan"),b=(0,n.useMemo)((()=>(0,o.L_)(f).map((e=>({isChecked:e===h,isEnabled:t.includes(e),role:e}))).sort(((e,t)=>Number(t.isEnabled)-Number(e.isEnabled)))),[t,o.L_,f,h]),y=(0,m.JT)("billing:ReadAll"),{url:E}=(0,u.A)();return n.createElement(l.Flex,{column:!0,gap:2,"data-testid":`${i}-roleOptions`},b.map((e=>{let{isChecked:t,isEnabled:o,role:r}=e;const m=o?void 0:"medium",u="troubleshooter"===r?"pro":"business";return n.createElement(l.RadioButton,{key:r,checked:t,"data-ga":`${a}::select-role-${r}::global-view`,"data-testid":`${i}-${r}Option`,disabled:!o,onChange:g,value:r,alignItems:"start"},n.createElement(l.Flex,{column:!0},n.createElement(l.Flex,{gap:2,alignItems:"center"},n.createElement(l.Text,{opacity:m},(0,s.Zr)(r)),!o&&n.createElement(v,{background:"sideBarMini",border:{side:"all",color:"border"},cursor:"initial",padding:[1],round:!0},n.createElement(c.A,{align:"bottom",as:d.N_,color:"text",Component:l.TextMicro,content:"Upgrade your plan in order to use this role","data-ga":`${a}::click-plan-badge-${u}::global-view`,disabled:!y,hoverColor:"textFocus",showToolTip:!0,strong:!0,to:E},"Upgrade now!"))),n.createElement(l.TextSmall,{color:"textLite",opacity:m},p[r])))})))}},77181:(e,t,a)=>{a.d(t,{c:()=>b,g:()=>f});a(17333),a(9920),a(41393),a(98992),a(54520),a(3949),a(81454),a(25509),a(65223),a(60321),a(41927),a(11632),a(64377),a(66771),a(12516),a(68931),a(52514),a(35694),a(52774),a(49536),a(21926),a(94483),a(16215);var n=a(96540),l=a(47444);const i=(0,l.Iz)({key:"invitation",default:{id:"",email:""}}),s=(0,l.Iz)({key:"invitationIds",default:[]});var o=a(31629);const r=e=>e.map((e=>{let{id:t,email:a}=e;return{id:t,email:a}})),c={member:1,admin:2,manager:3,troubleshooter:4,observer:5,billing:6},d=e=>e.map((e=>{let{role:t,...a}=e;if(void 0===c[t])throw new Error("role not found");return{role:c[t],...a}}));a(14905),a(8872);var m=a(78969);const u=e=>{let{data:t,invitations:a}=e;return t.reduce(((e,t,n)=>{var l;return(l=t.errorMsgKey)&&l===m.vK&&a[n]?.email&&e.push(a[n].email),e}),[])},p=e=>e.length>1;var v=a(65923);const g=(0,l.K0)({key:"spaceInvitationValue",get:e=>{let{id:t,key:a}=e;return e=>{let{get:n}=e;const l=n(i(t));return a?l[a]:l}}}),h=(0,l.K0)({key:"spaceInvitationsIdsValue",get:e=>t=>{let{get:a}=t;return a(s(e))},set:e=>(t,a)=>{let{set:n}=t,{invitations:l,merge:o}=a;n(s(e),(e=>[...new Set([...e,...l.map((e=>{let{id:t}=e;return t}))])])),l.forEach((e=>{n(i(e.id),(t=>({...o&&t,...e})))}))}}),f=e=>{const t=(0,l.vc)(h(e)),[a,c]=(0,n.useState)(!1),{activate:m}=(0,v.H)(),g=(0,l.Zs)((t=>{let{snapshot:a,set:n}=t;return async()=>{if(!(await a.getLoadable(h(e))).length){const{data:t}=await(e=>o.A.get(`/api/v2/spaces/${e}/invitations`,{transform:r}))(e);n(h(e),{invitations:t,merge:!0})}}}),[e]),f=(0,n.useCallback)((async(t,a,n)=>{let{onSuccess:l,onError:i}=n;try{c(!0);const{data:n}=await((e,t,a)=>o.A.post(`/api/v1/spaces/${e}/invitations`,{redirectURI:a,requests:d(t)}))(e,t,a),s=u({data:n,invitations:t});if(s.length&&!p(t))return void(i&&i({message:"User has already joined that space!"}));if(s.length&&p(t)){if(s.length===t.length)return void(i&&i({message:"All of the selected users are already meembers of this space"}));if(l)return void l({header:"Invitations partially send",text:"Some of the selected users are already members of this space"})}l&&l()}catch(s){i&&i(s)}finally{c(!1),m()}}),[e,m]),b=(0,l.Zs)((t=>{let{snapshot:a,set:n,reset:l}=t;return async t=>{const r=await a.getPromise(h(e)),c=r.filter((e=>e===t));n(s(e),(e=>{const t=new Set(e);return c.forEach((e=>t.delete(e))),[...t]}));try{await((e,t)=>o.A.delete(`/api/v1/spaces/${e}/invitations`,{params:{invitation_ids:t.join(",")}}))(e,[t]),c.forEach((e=>{l(i(e))}))}catch(d){n(h(e),{invitations:r,merge:!1})}}}),[e]);return(0,n.useEffect)((()=>{g()}),[e]),[t,b,f,a]},b=(e,t)=>(0,l.vc)(g({id:e,key:t}))}}]);