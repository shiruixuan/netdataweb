!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="749f31a7-a93b-4ee7-9e4f-d10d470a7abf",e._sentryDebugIdIdentifier="sentry-dbid-749f31a7-a93b-4ee7-9e4f-d10d470a7abf")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"c87aa722cb3cb6eb3ac10b8f2032443089be80ba"},(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[3730],{23730:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var n=a(96540),l=a(65336),r=a(32089),s=a(47444),o=a(3914),i=a(31629),c=a(49286);const d=(e,t)=>e&&t?i.A.post(`/api/v2/spaces/${e}/notifications`,t,{transform:c.bn}):Promise.resolve({data:{}}),u=(0,s.K0)({key:"notificationsState",get:e=>{let{spaceId:t}=e;return()=>(e=>e?i.A.get(`/api/v2/spaces/${e}/notifications`,{transform:c.bn}):Promise.resolve({data:{}}))(t)}}),f=()=>{const e=(0,o.vt)(),t=(0,s.xf)(u({spaceId:e})),a=(0,s.RH)(u({spaceId:e}));return{loaded:"loading"!==t.state,value:t.contents?.data,hasError:"hasError"===t.state,error:"hasError"===t.state?t.contents?.response?.data:null,refresh:a}},h=()=>{const e=(0,o.vt)();return(0,n.useCallback)((t=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e&&t.length?i.A.delete(`/api/v2/spaces/${e}/notifications`,{data:t}):Promise.resolve({data:{}})}(e,t)),[e])};var m=a(28738),y=a(98496);const g={missingCanReadNotifications:"You don't have permissions to view this page",default:"Something went wrong"},b=e=>{let{error:t}=e;const{errorMessage:a,errorMsgKey:r}=t||{},s=g[r]||a||g.default;return n.createElement(y.A,{title:"Error"},n.createElement(l.TextBig,null,s))};a(3064),a(98992),a(72577);var p=a(5628),v=a(46741),E=a(71835),A=a(92155);const I=(0,A.A)(l.Button),D=e=>{let{notifications:t,refresh:a,startLoading:r,stopLoading:s}=e;const{defaultReachabilityDelay:i,settings:c}=t||{},u=c.find((e=>{let{roomID:t}=e;return null==t})),{id:f,reachabilityDelay:m}=u||{},y=m&&m!=i,g=(()=>{const e=(0,o.vt)();return(0,n.useCallback)((t=>d(e,[{reachabilityDelay:t}])),[e])})(),b=h(),A=(0,v.JT)("space:NotificationsManage"),[D,w]=(0,E.A)(),x=(0,n.useCallback)((e=>{r(),g(e).then((()=>{D({header:"Success",text:"Successfully updated space delay"}),a()})).catch(w).finally(s)}),[g,a,r,s,D,w]),T=(0,n.useCallback)((()=>{f&&(r(),b([f]).then((()=>{D({header:"Success",text:"Successfully reset space delay"}),a()})).catch(w).finally(s))}),[f,b,a,r,s,D,w]);return n.createElement(l.Flex,{gap:2,alignItems:"end"},n.createElement(p.A,{value:null!==m&&void 0!==m?m:i,onChange:x,disabled:!A,disabledTooltip:"You don't have permissions to edit this value",testId:"space-reachability-delay-selector"}),y?n.createElement(I,{label:"Reset to Netdata's default delay",icon:"refresh",flavour:"borderless",textTransform:"",style:{height:"28px"},onClick:T,disabled:!A,payload:{testId:"space-reachability-delay-selector"}}):null)};var w=a(63950),x=a.n(w),T=(a(41393),a(81454),a(14994));const C=[{id:"name",accessor:"name",header:"Room",cell:e=>{let{getValue:t}=e;return n.createElement(l.Flex,{alignItems:"center"},n.createElement(l.Text,null,t()))}},{id:"reachabilityDelay",accessor:"reachabilityDelay",header:"Delay",cell:e=>{let{row:t,getValue:a}=e;const r=a(),s=t.original.id,{refresh:i}=f(),c=(()=>{const e=(0,o.vt)();return(0,n.useCallback)(((t,a)=>d(e,[{roomID:t,reachabilityDelay:a}])),[e])})(),u=(0,v.JT)("space:NotificationsManage"),[h,m]=(0,E.A)(),y=(0,n.useCallback)((e=>{c(s,e).then((()=>{h({header:"Success",text:"Successfully updated delay"}),i()})).catch(m)}),[s,c,i,h,m]);return n.createElement(l.Flex,{alignItems:"center"},n.createElement(p.A,{value:r,onChange:y,disabled:!u,disabledTooltip:"You don't have permissions to edit this value",testId:"room-reachability-delay-selector"}))}}],S=()=>{const{value:e,refresh:t}=f(),{defaultReachabilityDelay:a,settings:l}=e||{},r=l.find((e=>{let{roomID:t}=e;return null==t})),{reachabilityDelay:s}=r||{},o=(0,T.DL)(),i=(0,n.useMemo)((()=>o.map((e=>{const t=l.find((t=>{let{roomID:a}=t;return a==e.id})),n=t?.reachabilityDelay||s||a,r=t?.id;return{...e,settingId:r,reachabilityDelay:n}}))),[o,a,l]),c=h(),d=(0,v.JT)("space:NotificationsManage"),[u,m]=(0,E.A)(),y=(0,n.useMemo)((()=>({addRule:{handleAction:e=>{const{settingId:a}=e;a&&c([a]).then((()=>{u({header:"Success",text:"Successfully reset delay"}),t()})).catch(m)},icon:"refresh",flavour:"borderless",neutral:!1,isDisabled:e=>!d||!e.settingId,tooltipText:"Reset value",disabledTooltipText:d?"You cannot reset the default value":"You don't have permissions to reset this value",confirmation:!1}})),[d,t]);return{data:i,columns:C,rowActions:y}};a(17333),a(54520);const k=(0,A.A)(l.Button),L=e=>{let{notifications:t,refresh:a,startLoading:l,stopLoading:r}=e;const{settings:s}=t||{},o=(0,n.useMemo)((()=>s.filter((e=>{let{roomID:t}=e;return null!=t}))),[s]),i=!!o.length,c=h(),d=(0,v.JT)("space:NotificationsManage"),u=(0,n.useMemo)((()=>!d||!i),[d,i]),[f,m]=(0,E.A)(),y=(0,n.useCallback)((()=>{const e=o.map((e=>{let{id:t}=e;return t}));l(),c(e).then((()=>{f({header:"Success",text:"Successfully reset space delay"}),a()})).catch(m).finally(r)}),[o,l,c,f,a,m,r]);return n.createElement(k,{flavour:"borderless",label:"Reset all to space default",icon:"refresh",disabled:u,onClick:y})},R=e=>{let{notifications:t,refresh:a,startLoading:r,stopLoading:s}=e;const{data:o,columns:i,rowActions:c}=S({notifications:t});return n.createElement(l.Table,{data:o,dataColumns:i,rowActions:c,onSearch:x(),headerChildren:n.createElement(L,{notifications:t,refresh:a,startLoading:r,stopLoading:s})})};var M=a(87659),N=a(85630),_=a(51719),Y=a(63314);const F=()=>{const[e,,t,a]=(0,M.A)(),{loaded:s,value:o,hasError:i,error:c,refresh:d}=f(),{loaded:u,isPaid:h}=(0,N.A)(),y=(0,v.JT)("space:NotificationsRead");return!s||e?n.createElement(m.A,{height:"calc(100% - 97px)"}):i?n.createElement(b,{error:c}):y?n.createElement(Y.Ay,{tab:"Notifications::Reachability"},n.createElement(l.Flex,{column:!0,"data-testid":"reachability-notifications-container",gap:4,height:"100%",width:"100%",margin:[3,0],padding:[2,4]},n.createElement(l.Text,null,"Set delay for all reachability notifications for this space. The delay is automatically applied to all rooms, but you can also manually set specific delays for each room separately."),u&&!h?n.createElement(_.A,null):null,n.createElement(D,{notifications:o,refresh:d,startLoading:t,stopLoading:a}),n.createElement(r.A,null),n.createElement(R,{notifications:o,refresh:d,startLoading:t,stopLoading:a}))):n.createElement(b,{error:{errorMsgKey:"missingCanReadNotifications"}})}},51719:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(58168),l=a(96540),r=a(65336),s=a(54856),o=a(3914);const i=e=>{const t=(0,o.dg)();return l.createElement(r.Flex,(0,n.A)({gap:2,alignItems:"center"},e),l.createElement(r.Icon,{size:"small",color:"warning",name:"warning_triangle"}),l.createElement(r.Text,null,"This feature is only available to paid plans"),t?null:l.createElement(s.A,null))}}}]);