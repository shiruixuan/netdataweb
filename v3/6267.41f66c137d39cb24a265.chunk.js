!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2cfe4060-6403-4285-abb6-ba727ec2f4bc",e._sentryDebugIdIdentifier="sentry-dbid-2cfe4060-6403-4285-abb6-ba727ec2f4bc")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"c87aa722cb3cb6eb3ac10b8f2032443089be80ba"},(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[6267],{6267:(e,t,n)=>{n.r(t),n.d(t,{default:()=>po});var l=n(58168),r=n(96540),o=n(65336),a=n(11128),i=n(47762),s=n(47193),c=(n(3064),n(14905),n(98992),n(72577),n(8872),n(3914)),d=n(94390);const u=function(){let{selectedNode:e,nodes:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=(0,c.dg)(),l=(0,r.useMemo)((()=>t.reduce(((e,t)=>{let{id:l,ni:r,name:o,isLive:a,isPreferred:i,capabilities:s,labels:c}=t;return a&&s.dyncfg?.enabled&&(!n||i)?[...e,{label:o,value:l,isParent:0==r||"true"==c?._is_parent}]:e}),[])),[t,n]),[o,i]=(0,a.Oj)({extraKey:d.q4,merge:!1});let s=1==o.length?t.find((e=>e.id==o[0])):null;s&&(s={value:s.id,label:s.name,isParent:0==s.ni});const u=(0,r.useMemo)((()=>(e=>e?e?.id&&e?.name?{label:e.name,value:e.id,isParent:0==e.ni}:e:null)(e)||s||(l.length?l[0]:"")),[l]),[m,p]=(0,r.useState)(),g=(0,r.useCallback)((e=>{i([e.value]),p(e)}),[p,i]);return(0,r.useEffect)((()=>{u&&g(u)}),[u,g]),{options:l,node:m,setNode:g}};n(41393),n(81454);var m=n(63950),p=n.n(m),g=n(47130);const h=(0,g.A)(o.Icon),f=()=>r.createElement(o.Flex,{column:!0,gap:2,width:{max:80}},r.createElement(o.Text,{lineHeight:1.5},"Select the node you want to configure."),r.createElement(o.Text,{lineHeight:1.5},"You can"," ",r.createElement(o.Text,{strong:!0,color:"primary"},"apply your changes to multiple nodes")," ","by selecting ",r.createElement(o.Text,{strong:!0},"Submit to multiple nodes")," option of the"," ",r.createElement(o.Text,{strong:!0},"Submit")," button in the configuration form.")),b=(0,r.memo)((function(){let{node:e,setNode:t=p(),options:n=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.createElement(r.Fragment,null,r.createElement(o.Box,{width:"250px"},r.createElement(o.Flex,{column:!0,gap:1},r.createElement(o.Flex,{gap:1,alignItems:"center"},r.createElement(o.TextBig,null,"Node"),r.createElement(h,{name:"information",color:"text",tooltip:f,tooltipProps:{plain:!0,isBasic:!0,align:"right"}})),r.createElement(o.Select,{placeholder:"Select a node",options:n,value:e,onChange:t}))))}));n(74648),n(17333),n(8159),n(23215),n(54520),n(37550);var E=n(27467);const y=(0,r.createContext)({}),x=()=>{const e=(0,r.useContext)(y),[,t]=(0,E.N9)(),{searchItem:n,setSearchItem:l}=e||{},{term:o,props:a}=n||{},i=!!Object.keys(n.props||{}).length,s=(0,r.useCallback)((e=>{t({dyncfgSearchTerm:void 0}),l((t=>({...t,term:e})))}),[l,t]),c=(0,r.useCallback)(((e,t)=>{l((n=>({...n,props:{...n.props||{},[e]:t}})))}),[l]),d=(0,r.useCallback)((e=>{l((t=>{const n={...t};return n.props?.[e]&&delete n.props[e],n}))}),[l]),u=(0,r.useCallback)((()=>{l((e=>({...e,props:void 0})))}),[l]),m=(0,r.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";try{const n=new RegExp(o);return Object.keys(e.templateChildren||[]).length?Object.keys(e.templateChildren).some((e=>n.test(e))):n.test(e[t])}catch(n){return!0}}),[o]),p=(0,r.useCallback)((e=>{if(!a||!Object.entries(a).filter((e=>{let[,t]=e;return void 0!==t})).length)return!0;const t=Object.entries(a).every((t=>{let[n,l]=t;return e[n]==l}));return Object.keys(e.templateChildren||[]).length?Object.values(e.templateChildren).some((e=>Object.entries(a).every((t=>{let[n,l]=t;return e[n]==l})))):t}),[a]);if(!e)throw new Error("Attempt to use 'useSearch' outside of 'SearchContext.Provider'");return{searchItem:n,hasProps:i,searchForTerm:s,searchByProp:c,testString:m,testProps:p,removeSearchProp:d,resetFilters:u}},C=e=>{let{children:t}=e;const[{dyncfgSearchTerm:n}]=(0,E.N9)(),[l,o]=(0,r.useState)({term:n});return r.createElement(y.Provider,{value:{searchItem:l,setSearchItem:o}},t)},v=()=>{const{searchItem:e,searchForTerm:t}=x(),{term:n}=e||{};return r.createElement(o.Box,{width:"250px"},r.createElement(o.Flex,{column:!0,gap:1},r.createElement(o.TextBig,null,"Search"),r.createElement(o.SearchInput,{value:n,placeholder:"Search",onChange:t,size:"large",height:"33px",padding:[2,3]})))};var k=n(29217),A=n(32089),w=n(8711);const I=(0,w.default)(o.Flex).attrs((e=>({width:"100%",alignItems:"center",justifyContent:"between",gap:2,padding:[1],round:!0,cursor:"pointer",...e}))).withConfig({displayName:"styled__StyledSection",componentId:"sc-dutbst-0"})(["&:hover{background-color:",";}"],(0,o.getColor)("modalBackground")),S=(0,w.default)(o.Button).withConfig({displayName:"styled__StyledButton",componentId:"sc-dutbst-1"})(["&:before{content:",";width:18px;height:18px;display:",";align-items:center;justify-content:center;font-size:11px;font-weight:bold;position:absolute;top:-6px;left:-10px;border-radius:50%;background-color:",";color:",";z-index:10;}"],(e=>{let{warningItems:t}=e;return`"${t}"`}),(e=>{let{warningItems:t}=e;return t?"flex":"none"}),(0,o.getColor)("error"),(0,o.getColor)("bright"));var F=n(49286);const T=e=>{let{title:t="",props:n={},config:l={}}=e;const{searchItem:a,searchByProp:i,removeSearchProp:s}=x(),{props:c}=a||{},u=(0,r.useCallback)(((e,t)=>{const{searchCondition:n}=l[e]||{},r=Object.entries(n||{});if(r.length){const[e,n]=r[0];t?s(e):i(e,n)}}),[i,s]);return r.createElement(o.Flex,{column:!0,gap:1},r.createElement(o.TextBig,{strong:!0},t),r.createElement(o.Flex,{column:!0},Object.entries(l).map((e=>{let[t,{label:a,searchCondition:i}]=e;const s=(0,F.bn)(n||{})[t]||0,[m,p]=Object.entries(i)[0],g=!!c&&c[m]==p,h=d.zy.includes(t)&&s>0?{color:"error"}:{};return r.createElement(k.A,{key:t,content:l[t]?.tooltip,align:"bottom",isBasic:!0,base:{background:"main",padding:[2]}},r.createElement(I,{onClick:()=>u(t,g)},r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Checkbox,{checked:g}),r.createElement(o.TextBig,h,a)),r.createElement(o.TextBig,h,s)))}))))};var D=n(4659);const B=e=>{let{source_type:t,status:n}=e;const{hasProps:l,resetFilters:a}=x();return r.createElement(o.Flex,{column:!0,padding:[3],gap:2},r.createElement(o.Flex,{alignItems:"center",justifyContent:"between"},r.createElement(o.TextBig,{strong:!0},"Filters"),l?r.createElement(D.A,{onClick:a},"Clear"):null),r.createElement(A.A,{color:"border"}),r.createElement(T,{title:"Source type",props:t,config:d.V8}),r.createElement(A.A,{color:"border"}),r.createElement(T,{title:"Status",props:n,config:d.T_}))},P=(0,r.memo)(B),N=Object.keys(d.T_),M=Object.keys(d.V8),_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=t.reduce(((e,t)=>({...e,[t]:0})),{});return function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;for(let n=0;n<t.length;n++)if(t[n]==l[e]){const t=l[e];r[e]||(r[e]={}),r[e][t]=(r[e]?.[t]||0)+1}}},L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.attention||(t.attention={}),e.restart_required&&(t.attention.restart_required=(t.attention?.restart_required||0)+1),e.plugin_rejected&&(t.attention.plugin_rejected=(t.attention?.plugin_rejected||0)+1)},O=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.entries(e);if(n.length)for(let l=0;l<n.length;l++){const[e,r]=n[l];if(e.match(/\/[^/]+/g))return O(r,t);r.type&&"template"!=r.type&&(_("status",N)(r,t),_("source_type",M)(r,t),L(r,t))}return t},R=e=>{let{tree:t}=e;const{attention:n,source_type:l,status:o}=(0,r.useMemo)((()=>Object.keys(t)?O(t):{}),[t]);return{warningItems:(n?.restart_required||0)+(n?.plugin_rejected||0)+(o?.failed||0)+(o?.incomplete||0),menuItems:{attention:n,source_type:l,status:o}}};var j=n(87659);const $=e=>{let{tree:t={}}=e;const n=(0,r.useRef)(),[l,a,,i]=(0,j.A)(!1),{hasProps:s}=x(),{warningItems:c,menuItems:d}=R({tree:t});return r.createElement(r.Fragment,null,r.createElement(k.A,{align:"bottom",content:l?"Hide filters":"Show filters"},r.createElement(o.Flex,{ref:n},r.createElement(S,{flavour:s?"default":"hollow",icon:"filterList",onClick:a,warningItems:c}))),l&&n.current?r.createElement(o.Drop,{width:60,target:n.current,align:{top:"bottom",right:"right"},background:"modalTabsBackground",margin:[2,0,0],round:.5,close:i,onClickOutside:i,onEsc:i},r.createElement(P,d)):null)},z=(0,r.memo)($),H=(0,r.createContext)(),V={name:""},W=()=>{const e=(0,r.useContext)(H),{id:t,open:n,isNewItem:l,formData:o,setFormData:a,submitType:i,setSubmitType:s,isLoading:c,startLoading:d,stopLoading:u,fullPage:m,setFullPage:p,entityProps:g,isDirty:h,setIsDirty:f,error:b}=e||{},E=(0,r.useCallback)((e=>a((t=>({...t,name:e})))),[a]);if(!e)throw new Error("Attempt to use 'useConfigItemContext' outside of 'ConfigItemContext.Provider'");return{id:t,open:n,isNewItem:l,formData:o,setFormData:a,submitType:i,setSubmitType:s,setName:E,isLoading:c,startLoading:d,stopLoading:u,fullPage:m,setFullPage:p,entityProps:g,isDirty:h,setIsDirty:f,error:b}},Y=e=>{let{children:t,...n}=e;const[l,o]=(0,r.useState)(V),[a,i]=(0,r.useState)("submit");return r.createElement(H.Provider,{value:{...n,formData:l,setFormData:o,submitType:a,setSubmitType:i}},t)};var U=n(76243),q=n(92155);const K=(0,q.A)(U.A),G=function(){let{id:e,onClick:t,closeMenu:n=p(),buttonProps:o={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{open:a,isLoading:i,entityProps:s}=W(),{cmds:c=[]}=s||{},d=i,u=c.includes("update")?"Edit configuration":"You have no permissions to edit the configuration",m=(0,r.useCallback)((()=>{t(),n()}),[t,n]);return r.createElement(K,(0,l.A)({view:!0,forceAccess:a,feature:"DyncfgItem",payload:{id:e,label:a?"Close":"View"},tooltip:a?"Close":u,icon:a?"x":"pencilOutline",onClick:m,disabled:d},o))};var J=n(8239),Z=n(26688),Q=n(16607),X=n(81198);const ee=(0,Q.A)(o.Button),te=function(){let{title:e,template:t={},onCollapseExpand:n=p(),buttonProps:o={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=(0,X.UE)(e),[,i]=(0,J.QH)(),{cmds:s,user_disabled:c}=t,{isLoading:d,open:u,formData:m,entityProps:g,isNewItem:h}=W(),f=(0,Z.A)(),b=(0,r.useCallback)((()=>{d||(i(f({template:a,formData:m,entityProps:g})),n())}),[d,a,m,g,i,f,n]);return u&&!h&&s?.includes("add")?r.createElement(ee,(0,l.A)({icon:"copy",onClick:b,disabled:d||c},c?{}:{tooltip:"Copy this item and create a new one"},o)):null},ne=(0,r.createContext)({}),le=()=>(0,r.useContext)(ne),re=ne,oe=(0,w.default)(o.TextBig).withConfig({displayName:"styled__StyledTitle",componentId:"sc-16w9sl7-0"})(["font-family:monospace;"]),ae=(0,w.default)(o.Icon).attrs((e=>({opacity:"1",cursor:"pointer",...e}))).withConfig({displayName:"styled__StyledTemplateArrow",componentId:"sc-16w9sl7-1"})(["opacity:",";cursor:",";"],(e=>{let{hasTemplateChildren:t}=e;return t?"1":"0"}),(e=>{let{hasTemplateChildren:t}=e;return t?"pointer":"default"})),ie=(0,w.default)(o.Flex).withConfig({displayName:"styled__StyledHeader",componentId:"sc-16w9sl7-2"})(["height:","px;border-top:1px solid ",";border-left:1px solid ",";border-right:1px solid ",";border-bottom:1px solid ",";border-bottom-style:",";"],d.FL,(0,o.getColor)("border"),(0,o.getColor)("border"),(0,o.getColor)("border"),(0,o.getColor)("border"),(e=>{let{isOpenEntity:t}=e;return t?"none":"solid"})),se=(0,w.default)(o.Collapsible).withConfig({displayName:"styled__StyledCollapsible",componentId:"sc-16w9sl7-3"})(["height:",";max-height:",";overflow:auto;"],(e=>{let{open:t,fullPage:n}=e;return t&&n?"100%":"auto"}),(e=>{let{flavour:t,fullPage:n,isJob:l}=e;return"path"!=t?n?"calc(100% - 55px)":l?"500px":"unset":"unset"})),ce=(0,w.default)(o.TextBig).withConfig({displayName:"styled__StyledNodeName",componentId:"sc-16w9sl7-4"})(["font-family:monospace;"]),de=(0,w.default)(o.Flex).attrs((e=>({position:"absolute",column:!0,gap:1,top:"50%",left:"50%",...e}))).withConfig({displayName:"styled__StyledLoaderContainer",componentId:"sc-16w9sl7-5"})(["transform:translate(-50%,-50%);"]);var ue=n(71835),me=n(80158);const pe=()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.Fn,n=e?.response?.data||e||{};try{n=JSON.parse(n)}catch(a){}const{message:l,errorMessage:r,error_message:o}=n;return(0,me.Zr)(l||r||o||t)},ge=()=>{const[e,t,,n]=(0,ue.A)(),l=pe(),o=(0,r.useCallback)((function(){let{successMessage:t="Successfully saved"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l=>{let{data:{message:r}}=l;(r?n:e)({header:r?"Warning":"Success",text:r||t})}}),[e,n]),a=(0,r.useCallback)((function(){let{header:e="Error",text:n=d.Fn}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r=>{const o=l(r,n);t({header:e,text:o})}}),[t]);return[o,a]};var he=n(50876);const fe=(0,q.A)(U.A),be=e=>{let{id:t,open:n,onDecline:l,onConfirm:a}=e;return n?r.createElement(o.ConfirmationDialog,{title:"Delete item?",handleConfirm:a,handleDecline:l,confirmLabel:"Yes, delete",declineLabel:"No",backdropContainerProps:{zIndex:"120"},message:r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.TextBig,null,"You are going to completely remove ",r.createElement(oe,{strong:!0},t)," and this action cannot be reverted."),r.createElement(o.TextBig,null,"Are you sure that you want to delete this item?"))}):null},Ee=function(){let{id:e,onOpenConfirmation:t=p(),onCloseConfirmation:n=p(),buttonProps:o={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{isLoading:a,entityProps:i,startLoading:s,stopLoading:c}=W(),{type:d,cmds:u=[]}=i||{},{node:m}=le(),g=(0,J.OU)({id:e,node:m}),[h,f]=ge(),b=(0,J.Hj)(),[E,,y,x]=(0,j.A)(),{sendButtonClickedLog:C}=(0,he.A)(),v=a,k=(0,r.useCallback)((()=>{x(),s(),g().then((t=>{h({successMessage:"Successfully deleted configuration"})(t),C({feature:"DyncfgItem",description:"Confirm deletion",id:e}),b()})).catch((e=>{f({header:"Couldn't delete configuration"})(e)})).finally((()=>{c()}))}),[g,x,s,c,b,C,h,f]),A=(0,r.useCallback)((()=>{a||(y(),t())}),[a,y,t]),w=(0,r.useCallback)((()=>{x(),n()}),[x,n]);return"job"==d&&u.includes("remove")?r.createElement(r.Fragment,null,r.createElement(fe,(0,l.A)({edit:!0,feature:"DyncfgItem",payload:{id:e,label:"Delete"},icon:"trashcan",onClick:A,disabled:v,tooltip:"Delete"},o)),r.createElement(be,{id:e,open:E,onDecline:w,onConfirm:k})):null},ye=(0,q.A)(U.A),xe=function(){let{id:e,template:t={},closeMenu:n=p(),buttonProps:o={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{node:a}=le(),i=(0,J.ZN)({id:e,node:a}),[s,c]=ge(),{isLoading:d,entityProps:u,startLoading:m,stopLoading:g}=W(),{user_disabled:h}=t,{cmds:f=[]}=u||{},b=(0,J.O_)({node:a,id:e}),E=d||h,y=(0,r.useCallback)((()=>{n(),d||h||(m(),i().then((e=>{s({successMessage:"Successfully restarted configuration"})(e),b()})).catch((e=>{c({header:"Couldn't restart configuration"})(e)})).finally((()=>{g()})))}),[d,h,i,m,b,g,s,c,n]);return f.includes("restart")?r.createElement(ye,(0,l.A)({edit:!0,feature:"DyncfgItem",payload:{id:e,label:"Restart"},icon:"refresh",onClick:y,disabled:E,tooltip:"Restart"},o)):null},Ce=(0,q.A)(U.A),ve=e=>{let{id:t,template:n={},closeMenu:o=p(),buttonProps:a}=e;const{isLoading:i,entityProps:s,startLoading:c,stopLoading:d}=W(),{cmds:u=[],userDisabled:m}=s||{},[g,h]=(0,r.useState)(!m),{node:f}=le(),{user_disabled:b}=n,E=(0,J.DP)({id:t,node:f}),y=(0,J.O_)({node:f,id:t}),[x,C]=ge(),{sendButtonClickedLog:v}=(0,he.A)(),{hidden:k,isDisabled:A,tooltipText:w}=(0,U.j)({edit:!0,tooltip:g?"Disable":"Enable",disabled:i||b}),I=(0,r.useMemo)((()=>({...a,label:g?"Disable":"Enable",payload:{id:t,label:g?"Disable":"Enable"}})),[a,g]),S=(0,r.useCallback)((()=>{h((e=>!e)),o(),c(),E(!g).then((e=>{v({feature:"DyncfgItem",description:g?"Disable item":"Enable item",id:t}),x({successMessage:`Successfully ${g?"disabled":"enabled"} configuration`})(e),y()})).catch((e=>{v({feature:"DyncfgItem",description:`Failed to ${g?"disable":"enable"} item`,id:t}),h((e=>!e)),C({header:`Couldn't ${g?"disable":"enable"} configuration`})(e)})).finally((()=>{d()}))}),[b,g,E,c,h,y,v,x,C,o]),F=(0,r.useMemo)((()=>u.includes("enable")),[u]),T=(0,r.useMemo)((()=>u.includes("disable")),[u]);return!k&&F&&T?r.createElement(Ce,(0,l.A)({edit:!0,feature:"DyncfgItem",icon:"switch_off",onClick:S,disabled:A,tooltip:w},I)):null},ke=(0,g.A)(o.Button),Ae={small:!0,neutral:!0,tooltip:null,iconHeight:"12px"},we=["restart","remove"],Ie=["enable","disable"],Se=e=>{let{title:t,template:n,isOpenEntity:a,buttonProps:i={}}=e;const s=(0,r.useRef)(),[c,d,,u]=(0,j.A)(!1),[m,,p]=(0,j.A)(!1),{entityProps:g}=W(),{cmds:h=[]}=g||{},f=(0,r.useMemo)((()=>!!h.some((e=>we.includes(e)))||!(a||!Ie.every((e=>h.includes(e))))),[h,a]),b=(0,r.useCallback)((()=>{m||u()}),[u,m]);return r.createElement(r.Fragment,null,r.createElement(o.Flex,{ref:s},r.createElement(ke,(0,l.A)({icon:"nav_dots",onClick:d,tooltip:f?"Item actions":null,disabled:!f},i))),c&&f&&s.current?r.createElement(o.Drop,{width:25,target:s.current,align:{top:"bottom",right:"right"},background:"modalTabsBackground",margin:[2,0,0],round:.5,close:u,onClickOutside:b,onEsc:u},r.createElement(o.Flex,{column:!0,gap:1,padding:[2]},r.createElement(xe,{id:t,template:n,closeMenu:u,buttonProps:{...i,...Ae,label:"Restart"}}),a?null:r.createElement(ve,{id:t,template:n,closeMenu:u,buttonProps:{...i,...Ae}}),r.createElement(Ee,{id:t,onOpenConfirmation:p,onCloseConfirmation:u,buttonProps:{...i,...Ae,neutral:!1,danger:!0,iconColor:"error",label:"Delete"}}))):null)},Fe=()=>{const{id:e,isNewItem:t,entityProps:n}=W(),{node:l,path:r}=le(),{template:o}=n,a=(0,J.SD)({node:l,path:r,isNewItem:t})(t?o:e),i=(0,J._O)({node:l,id:o});return i?(0,F.Jz)(i):a||{}},Te="text",De={iconColor:Te,flavour:"borderless",color:Te,type:"button"},Be=(0,w.default)(o.Flex).attrs({alignItems:"center",border:{side:"all",color:"border"},round:!0}).withConfig({displayName:"itemActions__StyledContainer",componentId:"sc-1kpuq1a-0"})([""]),Pe=(Ne=G,e=>{let{open:t,...n}=e;return t?r.createElement(Be,{gap:1},r.createElement(Ne,n)):r.createElement(Ne,n)});var Ne;const Me=function(){let{title:e,open:t,isOpenEntity:n,isEditFromState:l,onViewButtonClick:o,onCollapseExpand:a=p()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=Fe();return r.createElement(r.Fragment,null,t?l?null:r.createElement(Be,{gap:1},r.createElement(te,{title:e,template:i,onCollapseExpand:a,buttonProps:De}),r.createElement(xe,{id:e,template:i,buttonProps:De}),r.createElement(Ee,{id:e,buttonProps:De}),n?null:r.createElement(ve,{id:e,template:i})):r.createElement(Se,{title:e,template:i,isOpenEntity:n,buttonProps:De}),r.createElement(Pe,{id:e,onClick:o,open:t,buttonProps:De}))},_e=(0,g.A)(o.Icon),Le=e=>{let{isDisabled:t,onClick:n}=e;const l=(0,r.useCallback)((()=>{t||n()}),[t,n]);return r.createElement(_e,{name:"x",onClick:l,color:"text",tooltip:t?null:"Clear selected items",disabled:t,noWrapper:!0,cursor:t?"default":"pointer"})};var Oe=n(28738);const Re=(0,g.A)(o.Flex),je=e=>{let{items:t,renderItem:n,titleOnExpanded:a="Hide items",titleOnCollapsed:i="Show items",tooltipOnExpanded:s=null,tooltipOnCollapsed:c=null,itemsContainerProps:d={}}=e;const[u,m]=(0,j.A)();return r.createElement(o.Flex,{column:!0,gap:2},r.createElement(Re,{alignItems:"center",gap:1,cursor:"pointer",onClick:m,tooltip:u?s:c},r.createElement(o.Icon,{name:"chevron_right",color:"textLite",rotate:u?3:1,size:"small"}),r.createElement(o.Text,{color:"textLite"},u?a:i)),r.createElement(o.Collapsible,{open:u,duration:0},r.createElement(o.Flex,(0,l.A)({column:!0,gap:1,width:"100%",background:"modalBackground",height:{max:40},overflow:"auto"},d),t.map(n))))},$e=e=>{let{id:t,reason:n}=e;return r.createElement(o.Flex,{key:t,column:!0,gap:2},r.createElement(oe,null,t),r.createElement(o.Flex,{padding:[2,4],background:"panelBg",border:{side:"left",color:"error"}},r.createElement(o.Text,null,n)))},ze="processed",He=function(){let{actionVerb:e=ze}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Icon,{name:"check",color:"primary"}),r.createElement(o.TextBigger,null,"All items were ",e," successfully."))},Ve=function(){let{actionVerb:e=ze}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Icon,{name:"x",color:"error"}),r.createElement(o.TextBigger,{color:"error"},"No item could be ",e,"."))},We=function(){let{success:e=0,fail:t=0,actionVerb:n=ze}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Icon,{name:"checkmark_s",color:"primary"}),r.createElement(o.TextBigger,null,e," item",e>1?"s":""," successfully ",n,".")),r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Icon,{name:"x",color:"error"}),r.createElement(o.TextBigger,{color:"error"},t," item",t>1?"s":""," could not be ",n,".")))},Ye=e=>{let{results:t,idsForAction:n,renderAllSuccess:l=He,renderAllFail:a=Ve,renderPartialFail:i=We}=e;const s=(0,r.useMemo)((()=>(t||[]).reduce(((e,t,l)=>[...e,...200!==t?.value?.data?.status?[{id:(n||[])[l],reason:t?.reason?.response?.data?.error_message||t?.reason?.response?.data?.errorMessage||t?.reason?.response?.data?.message||"Something went wrong"}]:[]]),[])),[t,n]),c=n.length-s.length;return t&&t.length?r.createElement(o.Flex,{column:!0,gap:2,padding:[2,4]},s.length?r.createElement(r.Fragment,null,s.length==n.length?a():i({success:c,fail:s.length}),r.createElement(je,{items:s,renderItem:$e,tooltipOnCollapsed:"Show failed items.",itemsContainerProps:{gap:3}})):l()):null},Ue=e=>{let{title:t="Progress",loading:n,results:l,idsForAction:a,onClose:i,resetSelectedItems:s,renderAllSuccess:c,renderAllFail:d,renderPartialFail:u}=e;const m=(0,J.Hj)(),p=(0,r.useCallback)((()=>{i(),s(),m()}),[m,i,s]);return r.createElement(o.Modal,{backdropContainerProps:{zIndex:"120"},backdropProps:{backdropBlur:!0}},r.createElement(o.ModalContent,{width:{min:100,base:140},background:"modalBackground",round:2,overflow:"hidden"},r.createElement(o.ModalHeader,{background:"modalBackground"},r.createElement(o.H4,null,t)),r.createElement(o.ModalBody,{padding:[4,0]},n?r.createElement(Oe.A,{title:"Processing items...",height:"160px",background:"modalBackground"}):null,r.createElement(Ye,{results:l,idsForAction:a,renderAllSuccess:c,renderAllFail:d,renderPartialFail:u})),r.createElement(o.ModalFooter,{gap:2},r.createElement(o.Button,{flavour:"hollow",small:!0,label:"Close",onClick:p}))))},qe=(0,q.A)(U.A),Ke={canDoAction:[],noAction:[]},Ge=e=>{let{selectedItems:t,onDecline:n,onConfirm:a,title:i="Proceed?",noActionTitle:s="No items available for this action",renderConfirmationMessage:c,...d}=e;const u=(0,r.useMemo)((()=>!t.canDoAction.length),[t.canDoAction]),m=(0,r.useCallback)((()=>{a(t)}),[t]);return r.createElement(o.ConfirmationDialog,(0,l.A)({title:u?s:i,handleConfirm:m,handleDecline:n,confirmLabel:"Yes",declineLabel:u?"Close":"No",isConfirmDisabled:!t.canDoAction.length,backdropContainerProps:{zIndex:"120"},message:c(t)},d))},Je=e=>{let{cmd:t,action:n,items:o,list:a,resetSelectedItems:i,isDisabled:s,actionIconProps:c={},confirmationDialogProps:d={},progressModalProps:u={}}=e;const[m,,p,g]=(0,j.A)(),[h,f]=(0,r.useState)(),[b,,E,y]=(0,j.A)(),[x,,C,v]=(0,j.A)(),k=(0,r.useMemo)((()=>a.reduce(((e,n)=>{const{id:l,cmds:r}=n;if(o.includes(l)){const l=r.includes(t)?"canDoAction":"noAction";return{...e,[l]:[...e[l],{...n,[l]:!0}]}}return e}),Ke)),[a,o]),A=(0,r.useMemo)((()=>(k?.canDoAction||[]).map((e=>{let{id:t}=e;return t}))),[k.canDoAction]),{payload:w={},...I}=c||{},S=(0,r.useCallback)((()=>{s||E()}),[s,E]),F=(0,r.useCallback)((()=>{p(),y(),C(),n({ids:A}).then((e=>{f(e),g()}))}),[p,g,n,A,y,C]);return r.createElement(r.Fragment,null,r.createElement(qe,(0,l.A)({edit:!0,feature:"DyncfgBulkAction",onClick:S,color:"text",iconColor:"text",flavour:"borderless",payload:{ids:A,...w},disabled:s},I,s?{tooltip:null}:{})),b?r.createElement(Ge,(0,l.A)({selectedItems:k,onDecline:y,onConfirm:F},d)):null,x?r.createElement(Ue,(0,l.A)({loading:m,results:h,idsForAction:A,onClose:v,resetSelectedItems:i},u)):null)},Ze=(0,g.A)(o.Icon),Qe=(0,r.memo)((e=>{let{id:t,canDoAction:n,noAction:l,noActionMessage:a}=e;const i=(0,r.useMemo)((()=>({name:n?"arrow_down":"x",color:n?"success":"error",rotate:n?3:0,tooltip:l?a:null})),[n,l]);return r.createElement(o.Flex,{key:t,alignItems:"center",gap:2},r.createElement(o.Flex,null,r.createElement(Ze,i)),r.createElement(oe,null,t))})),Xe=(0,g.A)(o.Icon),et="deleted",tt=(0,r.memo)((()=>r.createElement(Xe,{name:"question",color:"text",size:"small",noWrapper:!0,tooltip:"You cannot delete predefined items. Only items added by user can be deleted."}))),nt=(0,r.memo)((()=>r.createElement(o.Flex,{gap:2},r.createElement(o.TextBig,null,"None of the selected items can be deleted."),r.createElement(tt,null)))),lt=(0,r.memo)((e=>{let{canDoAction:t,noAction:n}=e;return r.createElement(r.Fragment,null,n.length?r.createElement(o.Flex,{gap:2},r.createElement(o.TextBig,{color:"warning"},n.length," of the selected items cannot be deleted."),r.createElement(tt,null)):null,r.createElement(je,{items:[...n,...t],renderItem:e=>r.createElement(Qe,(0,l.A)({},e,{noActionMessage:"Cannot be deleted."})),tooltipOnCollapsed:"Show items.",itemsContainerProps:{padding:[2]}}))})),rt=e=>{let{canDoAction:t,noAction:n}=e;return t.length?r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.TextBig,null,"You are going to completely remove ",r.createElement(o.TextBig,{strong:!0},t.length," items")," and this action cannot be reverted."),r.createElement(lt,{canDoAction:t,noAction:n}),r.createElement(o.TextBig,null,"Are you sure that you want to continue?")):r.createElement(nt,null)},ot=e=>{let{node:t,items:n,list:o,resetSelectedItems:a,isDisabled:i}=e;const s=(0,J.yW)({node:t});return r.createElement(Je,{cmd:"remove",action:s,items:n,list:o,resetSelectedItems:a,isDisabled:i,actionIconProps:{icon:"trashcan",tooltip:"Delete selected items",payload:{label:"Delete"}},confirmationDialogProps:{title:"Delete selected items?",noActionTitle:"No items to delete",confirmLabel:"Yes, delete",renderConfirmationMessage:rt},progressModalProps:{renderAllSuccess:e=>r.createElement(He,(0,l.A)({},e,{actionVerb:et})),renderAllFail:e=>r.createElement(Ve,(0,l.A)({},e,{actionVerb:et})),renderPartialFail:e=>r.createElement(We,(0,l.A)({},e,{actionVerb:et}))}})},at=(0,g.A)(o.Icon),it="restarted",st=(0,r.memo)((()=>r.createElement(at,{name:"question",color:"text",size:"small",noWrapper:!0,tooltip:"You can only restart specific items."}))),ct=(0,r.memo)((()=>r.createElement(o.Flex,{gap:2},r.createElement(o.TextBig,null,"None of the selected items can be restarted."),r.createElement(st,null)))),dt=(0,r.memo)((e=>{let{canDoAction:t,noAction:n}=e;return r.createElement(r.Fragment,null,n.length?r.createElement(o.Flex,{gap:2},r.createElement(o.TextBig,{color:"warning"},n.length," of the selected items cannot be restarted."),r.createElement(st,null)):null,r.createElement(je,{items:[...n,...t],renderItem:e=>r.createElement(Qe,(0,l.A)({},e,{noActionMessage:"Cannot be restarted."})),tooltipOnCollapsed:"Show items.",itemsContainerProps:{padding:[2]}}))})),ut=e=>{let{canDoAction:t,noAction:n}=e;return t.length?r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.TextBig,null,"You are going to restart ",r.createElement(o.TextBig,{strong:!0},t.length," items"),"."),r.createElement(dt,{canDoAction:t,noAction:n}),r.createElement(o.TextBig,null,"Are you sure that you want to continue?")):r.createElement(ct,null)},mt=e=>{let{node:t,items:n,list:o,resetSelectedItems:a,isDisabled:i}=e;const s=(0,J.nM)({node:t});return r.createElement(Je,{cmd:"restart",action:s,items:n,list:o,resetSelectedItems:a,isDisabled:i,actionIconProps:{icon:"refresh",tooltip:"Restart selected items",payload:{label:"Restart"}},confirmationDialogProps:{title:"Restart selected items?",noActionTitle:"No items to restart",confirmLabel:"Yes, restart",isConfirmPositive:!0,renderConfirmationMessage:ut},progressModalProps:{renderAllSuccess:e=>r.createElement(He,(0,l.A)({},e,{actionVerb:it})),renderAllFail:e=>r.createElement(Ve,(0,l.A)({},e,{actionVerb:it})),renderPartialFail:e=>r.createElement(We,(0,l.A)({},e,{actionVerb:it}))}})},pt=e=>{let{actionVerb:t}=e;return r.createElement(o.TextBig,null,"None of the selected items can be ",t,".")},gt=e=>{let{canDoAction:t,noAction:n,isDisable:a}=e;const i=a?"disabled":"enabled";return r.createElement(r.Fragment,null,n.length?r.createElement(o.TextBig,{color:"warning"},n.length," of the selected items cannot be ",i,"."):null,r.createElement(je,{items:[...n,...t],renderItem:e=>r.createElement(Qe,(0,l.A)({},e,{noActionMessage:`Cannot be ${i}.`})),tooltipOnCollapsed:"Show items.",itemsContainerProps:{padding:[2]}}))},ht=e=>t=>{let{canDoAction:n,noAction:l}=t;const a=e?"disable":"enable",i=e?"disabled":"enabled";return n.length?r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.TextBig,null,"You are going to ",a," ",r.createElement(o.TextBig,{strong:!0},n.length," items"),"."),r.createElement(gt,{canDoAction:n,noAction:l,isDisable:e}),r.createElement(o.TextBig,null,"Are you sure that you want to continue?")):r.createElement(pt,{actionVerb:i})},ft=e=>{let{isDisable:t,node:n,items:o,list:a,resetSelectedItems:i,isDisabled:s}=e;const c=(0,J.Ht)({disable:t,node:n}),d=t?"disabled":"enabled",u=(0,r.useMemo)((()=>({icon:"switch_off",danger:t,...t?{iconColor:"errorText",tooltip:"Disable selected items",payload:{label:"Disable"}}:{iconColor:"successText",tooltip:"Enable selected items",payload:{label:"Enable"}}})),[t]),m=(0,r.useMemo)((()=>({isConfirmPositive:!t,renderConfirmationMessage:ht(t),...t?{title:"Disable selected items?",noActionTitle:"No items to disable",confirmLabel:"Yes, disable"}:{title:"Enable selected items?",noActionTitle:"No items to enable",confirmLabel:"Yes, enable"}})),[t,ht]);return r.createElement(Je,{cmd:t?"disable":"enable",action:c,items:o,list:a,resetSelectedItems:i,isDisabled:s,actionIconProps:u,confirmationDialogProps:m,progressModalProps:{renderAllSuccess:e=>r.createElement(He,(0,l.A)({},e,{actionVerb:d})),renderAllFail:e=>r.createElement(Ve,(0,l.A)({},e,{actionVerb:d})),renderPartialFail:e=>r.createElement(We,(0,l.A)({},e,{actionVerb:d}))}})},bt=e=>{let{node:t,path:n,list:l}=e;const{items:a,reset:i}=(0,J.H2)({node:t,path:n}),s=!a.length;return r.createElement(Be,{gap:2,alignItems:"center",padding:[0,0,0,3]},r.createElement(Le,{isDisabled:s,onClick:i}),r.createElement(o.TextBig,{color:s?"textLite":"text"},a.length," selected"),r.createElement(o.Flex,{alignItems:"center"},r.createElement(mt,{node:t,items:a,list:l,resetSelectedItems:i,isDisabled:s}),r.createElement(ot,{node:t,items:a,list:l,resetSelectedItems:i,isDisabled:s}),r.createElement(ft,{node:t,items:a,list:l,resetSelectedItems:i,isDisabled:s}),r.createElement(ft,{isDisable:!0,node:t,items:a,list:l,resetSelectedItems:i,isDisabled:s})))},Et=()=>{const e=(0,J.Hj)();return r.createElement(k.A,{align:"bottom",content:"Reload"},r.createElement(o.Flex,null,r.createElement(o.Button,{flavour:"hollow",icon:"refresh",onClick:e})))},yt=(0,r.memo)(Et);var xt=n(39225),Ct=n(40961);const vt=e=>{let{open:t,onDecline:n,onConfirm:l}=e;return t?r.createElement(o.ConfirmationDialog,{title:"Discard changes?",handleConfirm:l,handleDecline:n,confirmLabel:"Yes, discard",declineLabel:"No, keep editing",backdropContainerProps:{zIndex:"120"},message:r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.TextBig,null,"If you exit Edit mode before submit, your changes will be lost."),r.createElement(o.TextBig,null,"Are you sure?"))}):null},kt=e=>(0,r.useEffect)((()=>{if(!e)return;const t=t=>{"Escape"==t.code&&e(t)};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)}),[e]),At=e=>{let{title:t,open:n,isLoading:l,isDirty:o,setIsDirty:a,toggle:i,refresh:s,refreshUserConfig:c,entityProps:u,error:m}=e;const p=u[d.D9],g=["single","job"].includes(u?.type),[,h]=(0,J.QH)(),[f,,b,E]=(0,j.A)(),y=(0,r.useCallback)((()=>{o&&(a(!1),i(),E()),s(),c(),h(null)}),[t,h,o,a,i,s,c,E]),x=(0,r.useCallback)((e=>{l||(p||o?m||e?y():b():i())}),[l,p,o,m,y,b,i]);return kt((e=>{"Escape"==e.code&&n&&g&&(e.preventDefault(),x())})),{confirmationOpen:f,closeConfirmation:E,onConfirm:y,onClick:x}};n(25509),n(65223),n(60321),n(41927),n(11632),n(64377),n(66771),n(12516),n(68931),n(52514),n(35694),n(52774),n(49536),n(21926),n(94483),n(16215);const wt=()=>{const[e,t]=(0,r.useState)([]),n=(0,r.useCallback)((e=>t(e)),[t]);return{errors:e,onError:n,resetErrors:(0,r.useCallback)((()=>t([])),[t])}},It=function(){let{defaultName:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t,formData:n,isNewItem:l}=W();return(0,r.useMemo)((()=>(l?n?.name:(0,X.J3)(t))||e),[l,n?.name,t,e])},St=function(){let{id:e,node:t,onError:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const l=(0,J.y8)({id:e,node:t}),o=It(),{setValue:a,setError:i}=(0,J.MQ)(),[,s]=ge(),c=s(),d="function"==typeof n?n:c,u=pe(),m=(0,r.useRef)();return(e,t)=>{m.current&&(clearTimeout(m.current),m.current=null);const n=null===t?t:t||o;m.current=setTimeout((()=>{l({name:n,payload:e}).then((e=>{a(e.data||"")})).catch((e=>{i(u(e)),d(e)}))}),500)}},Ft=e=>{let{id:t,node:n,data:l,userConfigIsOpen:o,submitMethod:a,setIsDirty:i,setError:s}=e;const{isNewItem:c,isDirty:d,formData:u,setFormData:m,isLoading:g,startLoading:h,stopLoading:f,entityProps:b={}}=W(),{cmds:E=[]}=b,y=E.includes("userconfig"),x=pe(),{sendLog:C}=(0,he.A)(),[v,k]=(0,ue.A)(),{loaded:A,value:w,error:I,refresh:S}=(0,J.t8)({id:t,node:n}),{loaded:F,value:T,hasError:D,refresh:B}=l,P=d?u:T,N=A&&F,M=I||D,_=(0,J.Hj)(),L=(0,J.O_)({node:n,id:t}),O=St({id:t,node:n,onError:p()}),{errors:R,onError:j,resetErrors:$}=wt();(0,r.useEffect)((()=>{s(M)}),[M,s]);const z=(0,r.useCallback)(((e,t)=>{const n={...e.formData,name:T.name};m(n),i(!t),y&&o&&O(n)}),[T?.name,m,i,y,o,O]),H=(0,r.useCallback)((e=>{z({formData:e})}),[z]),V=(0,r.useCallback)((e=>{$();const n={...e.formData,...c&&u?.name?{name:u.name}:{}};h(),a(n).then((()=>{i(!1),c?_():(L(),S(),B()),v({header:"Success",text:"Successfully submitted configuration"}),C({feature:"DyncfgForm",description:"Submit success",id:t})})).catch((e=>{const n=x(e);k({header:"Error",text:n}),C({feature:"DyncfgForm",description:"Submit error",id:t,error:JSON.stringify(e.response?.data||{})})})).finally((()=>{f()}))}),[c,u?.name,a,h,f,i,_,L,S,B,x,j,$,v,k,C]);return{isLoading:g,loaded:N,formData:P,setFormData:H,refreshData:B,schema:w,resourcesError:M,errors:R,onChange:z,onSubmit:V,onError:j,getUserConfig:O}},Tt=(0,g.A)(o.Flex),Dt=(0,g.A)(o.Checkbox),Bt=(0,g.A)(ae),Pt=e=>{let{source:t="",sourceType:n}=e;const l=t.split(",");return r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.Flex,{alignItems:"center",gap:1},r.createElement(o.Text,{strong:!0},"Source type"),r.createElement(o.Pill,null,n)),r.createElement(o.Flex,{column:!0,gap:1},l.length?l.map((e=>r.createElement(o.TextSmall,{key:e},e))):null))},Nt=(0,r.memo)((e=>{let{source:t,sourceType:n,...a}=e;const i=(0,r.useMemo)((()=>d.V6[n]),[n]);if(!i)return null;const{icon:s}=i;return r.createElement(k.A,{isBasic:!0,content:r.createElement(Pt,{source:t,sourceType:n})},r.createElement(o.Flex,null,r.createElement(o.Icon,(0,l.A)({name:s},a))))})),Mt=(0,r.memo)((e=>{let{type:t,status:n}=e;const l=(0,r.useMemo)((()=>d.bM[n]),[n]);if(!l)return null;const{label:a,color:i,icon:s}=l;return"template"!=t?r.createElement(Tt,{width:{min:6},gap:1,padding:[1],round:!0,alignItems:"center",justifyContent:"center",tooltip:a},r.createElement(o.Icon,{name:s,height:"16px",color:i})):null})),_t=()=>r.createElement(o.Flex,{width:{max:100}},r.createElement(o.Text,null,"You can submit your changes to another node, or to multiple nodes by selecting"," ",r.createElement(o.Text,{strong:!0},"Submit to multiple nodes")," button.")),Lt=()=>{const{submitType:e}=W(),{node:t,nodes:n}=le(),[l]=(0,a.Oj)({extraKey:"dyncfg",merge:!1}),i=n.filter((e=>{let{value:t}=e;return l.includes(t)})),s=i.length?i[0].label:"0",c="submit"==e?t.label:s,d=l.length>1?`and ${l.length-1} more`:"",u="submit"==e?"node":l.length>1?"nodes":"node";return r.createElement(o.Flex,{"data-testid":"dyncfg-on-node",gap:2,alignItems:"center"},r.createElement(o.TextBig,null,"on"),r.createElement(Tt,{padding:[1],background:"mainBackground",tooltip:"submit"==e?r.createElement(_t,null):null,tooltipProps:{isBasic:!0,plain:!1}},r.createElement(ce,{strong:!0},c)," "),r.createElement(o.TextBig,null,"multiple_submit"==e?r.createElement(o.TextBig,{strong:!0},`${d} `):null,u))},Ot=e=>{let{title:t,isOpenContainer:n,type:l,source:a,sourceType:i,status:s,templateChildren:c={},onCollapseExpand:u,userDisabled:m}=e;const g=(0,r.useRef)(),{color:h}=d.g7[l]||d.g7.default,f=(0,r.useMemo)((()=>m||"disabled"==s?"disabled":h),[m,s,h]),{node:b,path:E}=le(),{open:y,isNewItem:x,formData:C,setName:v,entityProps:k={}}=W(),{cmds:A=[]}=k,w=A.includes("userconfig"),{name:I}=C||{},S=St({id:t,node:b,onError:p()}),{items:F,toggle:T,isSelected:D,setItems:B}=(0,J.H2)({node:b,path:E}),P="template"==l,N=Object.keys(c||{}),M=!!N.length,_=(0,r.useMemo)((()=>N.filter((e=>F.includes(e)))),[N,F]),L=(0,r.useMemo)((()=>_.length==N.length),[_,N]),O=(0,r.useMemo)((()=>_.length>0&&_.length<N.length),[_,N]),R=(0,r.useCallback)((e=>{const t=(e.target.value||"").replace(/ /g,"_");v(t),w&&S(C,t||"test")}),[C,v,w,S]),j=(0,r.useCallback)((()=>{P?B((e=>L?e.filter((e=>!N.includes(e))):Array.from(new Set([...e,...N])))):T(t)}),[t,P,N,T,B]);return(0,r.useEffect)((()=>{g.current&&g.current.focus()}),[g.current]),r.createElement(o.Flex,{gap:2,alignItems:"center",padding:[0,0,0,P?0:2]},P?r.createElement(Bt,{name:"chevron_right",color:"textLite",rotate:n?3:1,onClick:u,hasTemplateChildren:M,tooltip:n?"Hide children":"Show children"}):null,y||x?null:r.createElement(o.Flex,{padding:[0,1,0,0]},r.createElement(Dt,{checked:P?M&&L:D(t),indeterminate:P&&!!O,onChange:j,tooltip:P?M?"Select all":null:"Select",disabled:P&&!M})),r.createElement(Mt,{type:l,status:s}),r.createElement(Nt,{source:a,sourceType:i,color:f}),x?null:r.createElement(oe,{color:f},(0,X.J3)(t)),x&&y?r.createElement(o.TextInput,{inputRef:g,"data-testid":"dyncfg-config-item-name",width:65,value:I,onChange:R,placeholder:"Add configuration name",error:x&&!C?.name,hideErrorMessage:!0}):null,"template"!=l&&y?r.createElement(Lt,null):null)},Rt=(0,r.memo)(Ot),jt=(0,q.A)(U.A),$t=function(){let{title:e,buttonProps:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[,n]=(0,J.QH)(),o=(0,Z.A)(),{isLoading:a,entityProps:i}=W(),{cmds:s=[]}=i||{},c=a,d=(0,r.useCallback)((()=>{n(o({template:e,entityProps:i}))}),[e,i,o,n]);return s.includes("add")?r.createElement(jt,(0,l.A)({edit:!0,feature:"DyncfgTemplate",payload:{id:e,label:"Add job"},tooltip:"Add a new configuration item",icon:"plus",iconWidth:18,iconHeight:18,onClick:d,disabled:c},t)):null},zt=(0,q.A)(U.A),Ht=e=>{let{id:t,enable:n,open:l,onDecline:a,onConfirm:i}=e;const s=n?"enable":"disable";return l?r.createElement(o.ConfirmationDialog,{title:`${(0,me.Zr)(s)} item?`,handleConfirm:i,handleDecline:a,confirmLabel:`Yes ${s}`,declineLabel:"No",isConfirmPositive:!!n,message:r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.TextBig,null,"You are about to ",s," ",r.createElement(oe,{strong:!0},t)," module and all its configurations."),r.createElement(o.TextBig,null,"Are you sure?"))}):null},Vt=e=>{let{id:t,userDisabled:n,buttonProps:l={},cmds:o=[]}=e;const{isLoading:a,startLoading:i,stopLoading:s}=W(),{node:c}=le(),d=(0,J.DP)({id:t,node:c}),u=(0,J.O_)({node:c,id:t}),[m,p]=ge(),[g,h]=(0,r.useState)(),[f,,b,E]=(0,j.A)(),y=(0,r.useCallback)((()=>{E(),i(),d(g).then((e=>{u(),m({successMessage:`Successfully ${g?"enabled":"disabled"} module`})(e)})).catch((e=>{p({header:`Couldn't ${g?"enabled":"disabled"} module`})(e)})).finally((()=>{s()}))}),[E,i,d,u,m,p,s]),x=(0,r.useMemo)((()=>n?!o.includes("enable"):!o.includes("disable")),[n,o]),C=(0,r.useCallback)((e=>{a||x||(h(e),b())}),[a,x,b]),v=(0,r.useMemo)((()=>({edit:!0,feature:"DyncfgTemplate",payload:{id:t,label:n?"Enable":"Disable"},isLoading:a,disabled:a||x,...l,...n?{tooltip:x?"You cannot enable this module":"Enable this module",icon:"switch_off",iconColor:x?"textLite":"disabled",onClick:()=>C(!0)}:{tooltip:x?"You cannot disable this module":"Disable this module",icon:"switch_off",iconColor:x?"textLite":"success",onClick:()=>C(!1),danger:!0}})),[t,n,a,l,x,C]);return r.createElement(r.Fragment,null,r.createElement(zt,v),r.createElement(Ht,{id:t,enable:g,open:f,onDecline:E,onConfirm:y}))},Wt="success",Yt={iconColor:Wt,flavour:"borderless",color:Wt},Ut=e=>{let{title:t,userDisabled:n,cmds:l}=e;return r.createElement(r.Fragment,null,r.createElement($t,{title:t,buttonProps:Yt}),r.createElement(Vt,{id:t,userDisabled:n,buttonProps:Yt,cmds:l}))},qt=e=>{let{title:t,open:n,onViewButtonClick:l,onCollapseExpand:a,type:i,userDisabled:s,isOpenEntity:c,isEditFromState:d,cmds:u}=e;return r.createElement(o.Flex,{gap:2,alignItems:"center"},"template"==i?r.createElement(Ut,{title:t,userDisabled:s,cmds:u}):r.createElement(Me,{title:t,open:n,onViewButtonClick:l,onCollapseExpand:a,isOpenEntity:c,isEditFromState:d}))};var Kt=n(67742);const Gt=(0,g.A)(o.Icon),Jt={vertical:2,horizontal:4},Zt=e=>{let{path:t,isOpenContainer:n,onClick:a,...i}=e;return r.createElement(o.Flex,(0,l.A)({gap:2,onClick:a,cursor:"pointer"},i),r.createElement(Gt,{name:"chevron_right",color:"textLite",rotate:n?3:1,tooltip:n?"Hide children":"Show children"}),r.createElement(oe,{strong:!0},t))},Qt=e=>{let{frequency:t=20}=e;const[n,l]=(0,r.useState)(t),[a,i]=(0,r.useState)(0),s=(0,r.useCallback)((()=>{100!=a?i((e=>e+5)):l(void 0)}),[i,l]);return(0,Kt.A)(s,n),r.createElement(de,{"data-testid":"dyncfg-header-loader-container"},r.createElement(o.Text,null,"Loading schema..."),r.createElement(o.ProgressBar,{background:"border",border:"none",color:["green","netdata"],containerWidth:"100%","data-testid":"dyncfg-schema-loading-progress-bar",height:1,width:`${a}%`}))},Xt=e=>{let{flavour:t,title:n,open:o,toggleOpen:a,onViewButtonClick:i,level:s,fullPage:c,entityProps:d={},isOpenEntity:u,isEditFromState:m,schemaLoaded:p}=e;const{vertical:g,horizontal:h}=Jt,f=(0,r.useMemo)((()=>[g,h,g,o&&c?h:h*s]),[s,o,c]),b="path"==t,{items:E,toggle:y}=(0,J.qK)(),x=(0,r.useMemo)((()=>!E.includes(n)),[E,n]),C=(0,r.useCallback)((()=>{y(n),"template"!==d?.type&&a()}),[n,y,a,d?.type]);return r.createElement(ie,{position:"relative",alignItems:"center",justifyContent:"between",padding:f,isOpenEntity:u},b?r.createElement(Zt,{path:n,isOpenContainer:x,onClick:C}):r.createElement(r.Fragment,null,o&&!p?r.createElement(Qt,null):r.createElement(r.Fragment,null,r.createElement(Rt,(0,l.A)({title:n,isOpenContainer:x,onCollapseExpand:C},d)),r.createElement(qt,(0,l.A)({title:n,open:o,onViewButtonClick:i,onCollapseExpand:C,isOpenEntity:u,isEditFromState:m},d)))))},en=e=>{let{collapsibleProps:t,loaderProps:n,level:o,setIsDirty:a,setError:i,showLoader:s,renderChildren:c}=e;return r.createElement(r.Fragment,null,r.createElement(se,t,c({level:o+1,setIsDirty:a,setError:i})),s?r.createElement(Oe.A,(0,l.A)({title:"Loading..."},n)):null)},tn=e=>{let{title:t,isNewItem:n,isLoading:a,startLoading:i,stopLoading:s,fullPage:c,setFullPage:d,entityProps:u,isDirty:m,setIsDirty:g,error:h,flavour:f,handleViewButtonClick:b,open:E,toggleOpen:y,level:x,isEditFromState:C,setError:v,schema:k,schemaLoaded:A,renderChildren:w=p(),...I}=e;const S="path"==f,F=["single","job"].includes(u?.type),T="job"==u?.type,D="path"!=f&&E&&a,{containerProps:B,collapsibleProps:P,loaderProps:N}=(0,r.useMemo)((()=>({containerProps:{...E&&c?{position:"fixed",zIndex:"45",top:"5vh",left:"5vw",width:"90vw",height:"90vh"}:{position:"relative"},...E&&F?{border:{side:"all",color:"border"}}:{},...c?{}:{height:"100%"},background:F&&E?"modalBackground":"mainBackground",round:!0},collapsibleProps:{level:x,open:E,duration:0,flavour:f,fullPage:c,isJob:T,...E&&F?{padding:[2,2,2,c?4:4*x]}:{}},loaderProps:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:".9",zIndex:"100"}})),[E,c,F,x,f,T]),M=(0,r.useMemo)((()=>({collapsibleProps:P,loaderProps:N,level:x,setIsDirty:g,setError:v,showLoader:D,renderChildren:w})),[P,N,x,g,v,D,w]);return r.createElement(Y,{id:t,open:E,isNewItem:n,isLoading:a,startLoading:i,stopLoading:s,fullPage:c,setFullPage:d,entityProps:u,isDirty:m,setIsDirty:g,error:h},r.createElement(o.Flex,(0,l.A)({"data-testid":`dyncfg-config-item-container-${t}`,column:!0},B,I),r.createElement(Xt,{key:E,flavour:f,open:E,toggleOpen:y,title:t,onViewButtonClick:b,level:x,fullPage:c,entityProps:u,isOpenEntity:E&&!!F,isEditFromState:C,schemaLoaded:A}),!S&&A&&k?r.createElement(en,M):null))},nn=(e,t)=>{const n=["schema_update"].includes(e.lastAction);switch(t.type){case"expand":return{...e,expanded:!0,lastAction:"expand"};case"minimize":return{...e,expanded:!1,lastAction:"minimize"};case"schema_update":return{...e,expanded:n?t.schemaFullPage:e.expanded,...n?{lastAction:"schema_update"}:{}}}},ln=e=>{let{id:t,node:n}=e;const l=(0,J.K_)({id:t,node:n});return(0,r.useEffect)((()=>{l()}),[t,n]),null},rn=e=>{let{flavour:t="path",title:n="",level:o=1,entityProps:a={},isNewItem:i,isOpen:s,isEditFromState:c,renderChildren:d=p(),...u}=e;const m=i?u.id:n,[g,h]=(0,j.A)(i||s),{node:f}=le(),b=(0,J._O)({node:f,id:n})||a,[E,,y,x]=(0,j.A)(),[C,v]=(0,r.useReducer)(nn,{expanded:!!i||!!c,lastAction:"schema_update"}),[k,A]=(0,r.useState)(),[w,I]=(0,r.useState)(),{refresh:S}=(0,J.L5)(),{refresh:F}=(0,J.MQ)(),T=["single","job"].includes(b?.type),D=(0,r.useMemo)((()=>C.expanded),[C.expanded]),[,B]=(0,ue.A)(),{loaded:P,value:N,error:M}=(0,J.t8)({id:m,node:f}),_=(0,r.useCallback)((e=>{v({type:e?"expand":"minimize"})}),[v]),L=(0,r.useCallback)((e=>{v({type:"schema_update",schemaFullPage:e})}),[v]),{confirmationOpen:O,closeConfirmation:R,onConfirm:$,onClick:z}=At({title:n,open:g,isLoading:E,isDirty:w,setIsDirty:I,refresh:S,refreshUserConfig:F,toggle:h,entityProps:b,error:k}),H=(0,r.useCallback)((e=>{g&&S(),z(e)}),[g,S,z]);(0,r.useEffect)((()=>{g||F()}),[g,F]),(0,r.useEffect)((()=>{P&&N&&!M&&L(!0)}),[P,N,M,L]),(0,r.useEffect)((()=>{M&&(g?H(!0):B({header:"Schema error",message:M}))}),[g,M,H,B]);const V=(0,r.useMemo)((()=>({title:n,isLoading:E,startLoading:y,stopLoading:x,fullPage:D,setFullPage:_,entityProps:b,isNewItem:i,isDirty:w,setIsDirty:I,error:k,flavour:t,handleViewButtonClick:H,open:g,toggleOpen:h,level:o,setError:A,isEditFromState:c,schema:N,schemaLoaded:P,renderChildren:d,...u})),[n,E,y,x,D,_,b,i,w,I,k,t,H,g,h,o,A,c,N,P,d,u]);return r.createElement(r.Fragment,null,g&&T&&m&&f?r.createElement(ln,{id:m,node:f}):null,g&&P&&!M?(0,Ct.createPortal)(r.createElement(tn,(0,l.A)({},V,{"data-testid":"in-portal"})),document.body):r.createElement(tn,V),r.createElement(vt,{open:O,onDecline:R,onConfirm:$}))};var on=n(74810),an=n(36091),sn=n(87292),cn=n(68831);const dn=w.default.span.withConfig({displayName:"markdocSchema__Strong",componentId:"sc-1se2vza-0"})(["font-weight:bold;"]),un=w.default.ol.withConfig({displayName:"markdocSchema__OrderedList",componentId:"sc-1se2vza-1"})(["list-style:roman;padding-left:14px;"]),mn=w.default.ul.withConfig({displayName:"markdocSchema__UnorderedList",componentId:"sc-1se2vza-2"})(['list-style-image:url("','/img/list-style-image.svg");padding-left:14px;'],cn.A.assetsBaseURL),pn={heading:{render:e=>{let{level:t=1,...n}=e,a=o.H1;switch(t){case 2:a=o.H2;break;case 3:a=o.H3;break;case 4:a=o.H4;break;case 5:a=o.H5;break;case 6:a=o.H6}return r.createElement(a,(0,l.A)({margin:[2,0]},n))},attributes:{id:{type:String},level:{type:Number}}},paragraph:{render:e=>{let{children:t,...n}=e;return r.createElement(o.Flex,n,r.createElement(o.Text,null,t))}},strong:{render:dn},link:{render:e=>{let{children:t,href:n,...o}=e;return r.createElement(D.A,(0,l.A)({href:n,rel:"noopener noreferrer",target:"_blank"},o),t)},attributes:{href:{type:String}}},code:{render:e=>{let{content:t,...n}=e;return r.createElement(sn.R0,n,t)},attributes:{content:{type:String}}},fence:{render:e=>{let{content:t,...n}=e;return r.createElement(sn.Ay,n,t)},attributes:{content:{type:String}}},list:{render:e=>{let{ordered:t,children:n,...l}=e;const o=t?un:mn;return r.createElement(o,l,n)},attributes:{ordered:{type:Boolean}}}},gn=e=>{let{children:t}=e;return r.createElement(an.A,{transformConfiguration:{nodes:pn}},t)},hn=e=>{let{description:t}=e;return("string"==typeof t&&t?t:"object"==typeof t?t?.props?.description:null)?r.createElement(k.A,{isBasic:!0,plain:!0,allowHoverOnTooltip:!0,content:r.createElement(o.Flex,{width:{max:70}},r.createElement(gn,null,t))},r.createElement(o.Icon,{name:"information",color:"text",size:"small"})):null},fn=e=>{let{description:t}=e;if(!t)return null;const n="string"==typeof t?t:t.props?.description;return r.createElement(gn,null,n)},bn=e=>{let{title:t,required:n,description:l,help:a,isCollapsible:i,isExpanded:s,toggleExpanded:c}=e;return t?r.createElement(o.Flex,{column:!0,gap:.5},r.createElement(o.Flex,{alignItems:"center",gap:1},i?r.createElement(o.Icon,{name:"chevron_down",color:"text",onClick:c,cursor:"pointer",rotate:s?2:0}):null,r.createElement(o.TextBig,{strong:!0},t,n?"*":null),a?r.createElement(hn,{description:a}):null),r.createElement(o.Flex,i?{padding:[0,0,0,5]}:{},r.createElement(fn,{description:l}))):null},En=e=>{let{id:t,displayLabel:n,label:l,required:o,description:a,schema:i,uiSchema:s={}}=e;const c=s["ui:title"]||l,d=s["ui:help"],u=["array","boolean"].includes(i.type)||Array.isArray(i.type)&&(i.type.includes("array")||i.type.includes("boolean"));return c&&(n||u)?r.createElement("label",{htmlFor:t},r.createElement(bn,{title:c,required:o,description:a,help:d})):null},yn=e=>{let{id:t,label:n,required:l,description:a,errors:i,children:s,displayLabel:c,schema:d,classNames:u,hidden:m,uiSchema:p}=e;return m?null:r.createElement(o.Flex,{width:"100%",className:`${u} dyncfg-field-container`,column:!0,gap:.5},r.createElement(En,{id:t,displayLabel:c,label:n,required:l,description:a,schema:d,uiSchema:p}),r.createElement(o.Flex,{className:"dyncfg-field-content",column:!0,padding:[0,0,0,1]},s,i?r.createElement(o.TextMicro,{color:"errorText"},i):null))},xn=(e=>t=>{let{className:n,...l}=t;return n?.includes("dyncfg-grid")?r.createElement("div",{className:n},r.createElement(e,l)):r.createElement(e,l)})((e=>{let{onAddClick:t,schema:n,registry:a,properties:i,...s}=e;const{WrapIfAdditionalTemplate:c,ButtonTemplates:d}=a.templates,{AddButton:u}=d;return r.createElement(r.Fragment,null,r.createElement(o.Flex,(0,l.A)({className:"dyncfg-object-field-content",column:!0,gap:3,padding:[0,0,0,3],border:{side:"left",color:"border"}},s),i.map((e=>r.createElement(c,(0,l.A)({key:e.content.key,elemKey:e.content.key},e.content.props),e.content)))),n.additionalProperties?r.createElement(o.Flex,{padding:[2]},r.createElement(u,{onClick:t(n)})):null)})),Cn=(0,r.createContext)(),vn=e=>{let{children:t}=e;const[n,l]=(0,r.useState)({});return r.createElement(Cn.Provider,{value:{collapsibleItemsState:n,setCollapsibleItemsState:l}},t)},kn=e=>{const{properties:t,uiSchema:n}=e,{tabs:a,rest:i}=n["ui:options"]||{},[s,c]=(0,r.useState)(0),d=(0,r.useMemo)((()=>(e=>{let{properties:t=[],tabs:n=[]}=e;return n.map((e=>({...e,properties:t.filter((t=>e.fields.includes(t.name)))})))})({properties:t,tabs:a})),[t,a]);return r.createElement(vn,null,(i||[]).length?r.createElement(xn,(0,l.A)({},e,{properties:t.filter((e=>i.includes(e.name)))})):null,r.createElement(o.Tabs,{selected:s,onChange:c,height:"100%"},d.map((t=>{let{title:n,...a}=t;return r.createElement(o.Tab,{key:n,label:n},r.createElement(xn,(0,l.A)({},e,a,{border:{side:"top",color:"border"},padding:[2,0,0,3]})))}))))},An={tabs:{Component:kn},default:{Component:xn}},wn=e=>{const{title:t,description:n,required:l,uiSchema:a={},idSchema:i,formData:s}=e,c=i.$id,d=a["ui:flavour"],u=a["ui:help"],{Component:m}=An[d]||An.default,g=!!a?.["ui:collapsible"]||!!a?.["ui:options"]?.collapsible,{inContext:h,isItemDirty:f,isItemExpanded:b,setItemState:E}=(()=>{const e=(0,r.useContext)(Cn),{collapsibleItemsState:t,setCollapsibleItemsState:n}=e||{},l=(0,r.useCallback)((e=>void 0!==t[e]),[t]),o=(0,r.useCallback)((e=>t[e]),[t]),a=(0,r.useCallback)(((e,t)=>{n((n=>({...n,[e]:t})))}),[n]);return{inContext:!!e,isItemDirty:e?l:p(),isItemExpanded:e?o:p(),setItemState:e?a:p()}})(),y=a["ui:initiallyExpanded"]||!!s,x=(0,r.useMemo)((()=>f(c)?b(c):y),[f,b]),[C,v]=(0,j.A)(x);return(0,r.useEffect)((()=>{h&&E(c,C)}),[h,C,E]),r.createElement(o.Flex,{className:"dyncfg-object-field-container",width:"100%",column:!0,gap:2},t?r.createElement(bn,{title:t,required:l,description:n,help:u,isCollapsible:g,isExpanded:C,toggleExpanded:v}):null,r.createElement(o.Collapsible,{className:"dyncfg-object-field-collapsible",open:C||!g,duration:0},r.createElement(m,e)))},In=(0,r.forwardRef)(((e,t)=>{let{title:n,active:a,index:i,setActiveTab:s,onDropIndexClick:c,onReorderClick:d,reordering:u,setReordering:m,hasRemove:p,hasMoveUp:g,hasMoveDown:h,...f}=e;const{onAddIndexClick:b,onCopyIndexClick:E,...y}=f,x=(0,r.useCallback)((e=>{p&&c(e)()}),[p,c]);return(0,r.useEffect)((()=>{if(2==u?.length&&u[0]==i){const e=u[1];d(i,e)(),s(e),m()}}),[u]),r.createElement(o.NavigationTab,(0,l.A)({ref:t},y,{index:i,draggable:!!h&&!!g,active:a,icon:p?r.createElement(o.Icon,{name:"x",size:"small"}):null,onClick:()=>{s(i)},onRemove:x,fixed:!p}),r.createElement(o.TextBig,{whiteSpace:"nowrap"},n))})),Sn=(0,w.default)(o.IconButton).attrs((e=>({small:!0,padding:[0,1],...e}))).withConfig({displayName:"styled__StyledIconButton",componentId:"sc-xc1c2v-0"})(["height:",";"],(e=>{let{inTabs:t}=e;return t?"auto":"24px"})),Fn=e=>{let{icon:t,iconType:n,...o}=e;return r.createElement(Sn,(0,l.A)({flavour:"default",icon:"plus",tooltip:"Add item",type:"button",neutral:!1},o))},Tn=e=>{let{icon:t,iconType:n,...o}=e;return r.createElement(Sn,(0,l.A)({flavour:"hollow",icon:"copy",tooltip:"Copy current item into a new one",type:"button",neutral:!1},o))};var Dn=n(3705);const Bn=e=>{let{items:t,onAddClick:n,onCopyClick:l,canAdd:a}=e;const[i,{width:s}]=(0,Dn.A)(),[c,d]=(0,r.useState)(0),[u,m]=(0,r.useState)();(0,r.useEffect)((()=>{c>=t.length&&d(0)}),[t.length]);const p=a?`calc(${s}px - 80px)`:`${s}px`;return r.createElement(o.Flex,{ref:i,column:!0},r.createElement(o.Flex,{width:`${s}px`,margin:[0,0,2,0]},r.createElement(o.NavigationTabs,{width:p,overflow:{horizontal:"auto"}},r.createElement(o.DraggableTabs,{items:t.map(((e,t)=>({id:e.key,title:`Item ${t}`,active:c==t,setActiveTab:d,reordering:u,setReordering:m,...e}))),Item:In,onDragEnd:(e,t)=>{m([e,t])}})),a?r.createElement(r.Fragment,null,r.createElement(Tn,{onClick:()=>l(c),padding:[1,3],inTabs:!0,groupFirst:!0}),r.createElement(Fn,{onClick:n,padding:[1,3],inTabs:!0,groupLast:!0})):null),r.Children.map(t[c]?.children,(e=>r.isValidElement(e)?r.cloneElement(e,{title:""}):e)))},Pn=(0,r.memo)(Bn),Nn=e=>{let{icon:t,iconType:n,...o}=e;return r.createElement(Sn,(0,l.A)({flavour:"hollow",icon:"checkmark_partial_s",danger:!0,tooltip:"Remove item",type:"button"},o))},Mn=e=>{let{icon:t,iconType:n,...o}=e;return r.createElement(Sn,(0,l.A)({flavour:"hollow",icon:"sort_ascending",tooltip:"Move up",type:"button"},o))},_n=e=>{let{icon:t,iconType:n,...o}=e;return r.createElement(Sn,(0,l.A)({flavour:"hollow",icon:"sort_descending",tooltip:"Move down",type:"button"},o))},Ln=(0,w.default)(o.Flex).attrs((e=>({open:!0,...e}))).withConfig({displayName:"collapsible__ContentWrapper",componentId:"sc-6ate9-0"})(["display:",";"],(e=>{let{open:t}=e;return t?"flex":"none"})),On=(0,g.A)(o.Icon),Rn=e=>{let{title:t="",isCollapsible:n,isOpen:a,onChange:i,children:s,...c}=e;const[d,u]=(0,j.A)(a);return(0,r.useEffect)((()=>{i(d)}),[d]),n?r.createElement(o.Flex,{width:"100%",column:!0,padding:[3,0]},r.createElement(o.Flex,{gap:2},r.createElement(On,{name:"chevron_left",size:"small",color:"textLite",rotate:d?1:3,onClick:u,cursor:"pointer",tooltip:d?"Hide contents":"Show contents"}),t?r.createElement(o.Text,{strong:!0},t):null),r.createElement(Ln,(0,l.A)({open:d},c),s)):s},jn=e=>{let{hasMoveDown:t,hasMoveUp:n,hasRemove:l,index:a,totalItems:i,onAddIndexClick:s,onDropIndexClick:c,onReorderClick:d,canAdd:u,uiSchema:m={},onCopyClick:p,children:g}=e;const[h,f]=(0,r.useState)(!0),b=n||t||l||u,E=d(a,a-1),y=d(a,a+1),x=c(a),C=s(a+1),v=!!m?.["ui:collapsible"]||!!m?.["ui:options"]?.collapsible,k=(0,r.useCallback)((e=>{f(e)}),[f]);return r.createElement(o.Flex,{width:"100%",gap:2,alignItems:h?"start":"center",justifyContent:"between",border:{side:"all",color:"border"},padding:[2,4]},r.createElement(Rn,{isCollapsible:v,title:g.props?.title,isOpen:h,onChange:k},g),b?r.createElement(o.Flex,{gap:2,padding:[2,0]},n?r.createElement(Mn,{onClick:E}):null,t?r.createElement(_n,{onClick:y}):null,l?r.createElement(Nn,{onClick:x}):null,u?r.createElement(Tn,{onClick:()=>p(a)}):null,u&&a==i-1?r.createElement(Fn,{onClick:C}):null):null)},$n=e=>{let{onCopyClick:t,items:n}=e;return n.map((e=>r.createElement(jn,(0,l.A)({key:e.key,onCopyClick:t},e))))},zn=(0,r.memo)($n),Hn=e=>{let{canAdd:t,onAddClick:n,openEmptyItem:l}=e;return(0,r.useEffect)((()=>{l&&n()}),[l,n]),r.createElement(o.Flex,{gap:2,alignItems:"center"},r.createElement(o.TextBig,null,"No items"),t?r.createElement(Fn,{onClick:n}):null)},Vn=(0,g.A)(o.Toggle),Wn=e=>{const{items:t,canAdd:n,onAddClick:a,idSchema:i,formContext:s}=e,c="list"==e?.uiSchema?.["ui:listFlavour"],d=!!e?.uiSchema?.["ui:openEmptyItem"],[u,m]=(0,j.A)(c),{formData:p}=W(),g=u?zn:Pn,h=(0,r.useCallback)((e=>{const n=t[e]?.children?.props?.formData,{$id:l}=i,r=((e,t,n)=>{const l=e.replace(/^root_/,"").split("_");let r=n;for(let o=0;o<l.length;o++){const e=l[o];if(o===l.length-1){if(!Array.isArray(r[e]))throw new Error(`Expected an array at path ${l.slice(0,o+1).join("_")}`);r[e].push(t)}else r=r[e]}return n})(l,n,JSON.parse(JSON.stringify(p)));s.setFormData(r)}),[t,i,s.setFormData]);return r.createElement(o.Flex,{width:"100%",column:!0,gap:2,padding:[1,0,0,0]},r.createElement(o.Flex,null,r.createElement(Vn,{labelRight:"List",labelLeft:"Tabs",onChange:m,checked:u,tooltip:"Switch between list and tabs layout"})),t.length?r.createElement(g,(0,l.A)({},e,{onCopyClick:h})):r.createElement(Hn,{canAdd:n,onAddClick:a,openEmptyItem:d}))};var Yn=n(13539);const Un=e=>{let{elemKey:t,onKeyChange:n,schema:l,onDropPropertyClick:a,registry:i,children:s}=e;const[c,d]=(0,r.useState)(s?.props?.name||""),{RemoveButton:u}=i.templates.ButtonTemplates,m=Yn.Rr in l,p=(0,r.useCallback)((e=>{a(t)(e)}),[a,t]),g=(0,r.useCallback)((e=>d(e.target.value)),[d]);return m?r.createElement(o.Flex,{width:"100%",gap:2,alignItems:"center"},r.createElement(o.Flex,{column:!0,gap:1,flex:{grow:1,shrink:1}},r.createElement(o.TextBig,{strong:!0},"Key"),r.createElement(o.TextInput,{value:c,onInput:g,onBlur:e=>n(e.target.value),border:"inputBorder",size:"small"})),r.createElement(o.Flex,{flex:{grow:2,shrink:1}},s),r.createElement(o.Flex,{column:!0,gap:.5},r.createElement(o.TextBig,{opacity:"0"},"x"),r.createElement(u,{onClick:p}))):s},qn={FieldTemplate:yn,ArrayFieldTemplate:Wn,ObjectFieldTemplate:wn,WrapIfAdditionalTemplate:Un,ErrorListTemplate:()=>null,ButtonTemplates:{SubmitButton:()=>r.createElement(o.Button,{label:"Save"}),AddButton:Fn,RemoveButton:Nn,MoveUpButton:Mn,MoveDownButton:_n}},Kn=["integer","number"],Gn=e=>{let{value:t,type:n,disabled:a,onChange:i,onBlur:s,placeholder:c,schema:d,rawErrors:u,containerStyles:m}=e;const p=n?{type:n}:(e=>{let t="text";const{minimum:n,maximum:l,multipleOf:r}=e;return(Kn.includes(e.type)||Array.isArray(e.type)&&e.type.some((e=>Kn.includes(e))))&&(t="number"),{type:t,...null===n||isNaN(n)?{}:{min:n},...null===l||isNaN(l)?{}:{max:l},...null===r||isNaN(r)?"number"==e.type?{step:"0.01"}:{}:{step:r}}})(d);return r.createElement(o.TextInput,(0,l.A)({value:t||"",placeholder:c,onChange:e=>i(e.target?.value),onBlur:s,disabled:a,error:!!u?.length,hideErrorMessage:!0,border:"inputBorder",size:"small",containerStyles:m},p))},Jn=e=>{let{value:t,disabled:n,onChange:l}=e;return r.createElement(o.Flex,null,r.createElement(o.Checkbox,{checked:t,onChange:l,disabled:n}))},Zn=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||0==t.length)return"";if(Array.isArray(e)){return[...t.filter((t=>e.map((e=>"string"==typeof e?e:e.value)).includes(t.value))),...e.filter((e=>"object"==typeof e&&e.__isNew__))]}return t.find((t=>t.value==e))},Qn=e=>{let{value:t,options:n,disabled:l,multiple:a,onChange:i,uiSchema:s}=e;const{enumOptions:c}=n||{},d=s?.["ui:creatable"],u=(0,r.useCallback)((e=>{var t;i((t=e)?Array.isArray(t)?t.map((e=>e.value)):t.value||"":"")}),[]);return c?r.createElement(o.Select,{value:Zn(t,c),isMulti:a,options:c,onChange:u,isDisabled:l,isCreatable:d,styles:{size:"tiny"}}):null},Xn=e=>{let{value:t,disabled:n,onChange:l,uiSchema:a,options:i}=e;const s=a[Yn.ce],c=s?.enumOptions||i?.enumOptions,d=s?.inline,u=s?.flavour,m="buttonGroup"==u,p=(0,r.useMemo)((()=>({gap:2,...d?{alignItems:"center"}:{column:!0}})),[d]);if(m){const e=c.map((e=>({...e,title:e.schema?.description})));return r.createElement(o.ButtonGroup,{items:e,checked:t,onChange:l,buttonProps:{type:"button",small:!0}})}return c?r.createElement(o.Flex,p,c.map((e=>r.createElement(o.RadioButton,{key:e.value,checked:t==e.value,onChange:()=>l(e.value),disabled:n},r.createElement("label",{title:e?.schema?.description},e.label))))):null},el=w.default.textarea.withConfig({displayName:"textareaWidget__Textarea",componentId:"sc-3aqoej-0"})(["background:",";border-width:1px;border-style:solid;border-color:",";border-radius:2px;color:",";padding:8px 12px;opacity:",';font-size:14px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Ubuntu,"Helvetica Neue",sans-serif;'],(0,o.getColor)("inputBg"),(e=>{let{hasValue:t,error:n}=e;return t?(0,o.getColor)("text"):n?(0,o.getColor)("error"):(0,o.getColor)("inputBorder")}),(e=>{let{disabled:t,hasValue:n}=e;return n?(0,o.getColor)("text"):t?(0,o.getColor)("placeholder"):(0,o.getColor)("textLite")}),(e=>{let{disabled:t}=e;return t?".4":"1"})),tl=e=>{let{value:t,placeholder:n,disabled:l,onChange:o,options:a,rawErrors:i}=e;const{rows:s=2}=a||{};return r.createElement(el,{placeholder:n,disabled:l,onChange:e=>o(e.target.value),rows:s,hasValue:!!t,error:!!i?.length},t)};var nl=n(900),ll=n(56967),rl=n(20982);const ol=(0,w.default)(rl.g).withConfig({displayName:"passwordWidget__StyledIcon",componentId:"sc-6o8r4r-0"})(["position:absolute;right:8px;top:50%;transform:translateY(-50%);cursor:pointer;"]),al=(0,g.A)(ol),il=e=>{const[t,n]=(0,j.A)(),a=(0,r.useMemo)((()=>({type:t?"text":"password"})),[t]),i=(0,r.useMemo)((()=>({icon:t?ll.k6:nl.pS,tooltip:t?"Hide password":"Show password"})),[t]);return r.createElement(o.Flex,{position:"relative"},r.createElement(Gn,(0,l.A)({containerStyles:{width:"100%"}},a,e)),r.createElement(al,(0,l.A)({color:"text",onClick:n},i)))},sl=e=>r.createElement(Gn,(0,l.A)({type:"url"},e));var cl=n(40267);const dl=/^\$this\s*(==|>|<|>=|<=)\s*\((\d+)\)$/,ul=/^\$this\s*(==|>|<|>=|<=)\s*\(\(\$status\s*(==|>|<|>=|<=)\s*(\$WARNING|\$CRITICAL)\s*\)\s*\?\s*\((\d+)\)\s*:\s*\((\d+)\)\)$/,ml=Object.values({lt:{label:"Lower than",value:"lt",symbol:"<"},lte:{label:"Lower than or equal",value:"lte",symbol:"<="},eq:{label:"Equal",value:"eq",symbol:"=="},gt:{label:"Greater than",value:"gt",symbol:">"},gte:{label:"Greater than or equal",value:"gte",symbol:">="}}),pl={$CRITICAL:"critical",$WARNING:"warning"},gl={critical:"$CRITICAL",warning:"$WARNING"},hl=e=>{let{value:t,onChange:n,isDisabled:l}=e;const a=ml.find((e=>{let{symbol:n}=e;return n==t}))||"";return r.createElement(o.Select,{options:ml,value:a,onChange:n,isDisabled:l,styles:{size:"tiny"}})},fl=e=>{let{isDisabled:t,parsedExpression:n={},toggleRecoveryThreshold:l,onChangeThreshold:a}=e;const{isComplex:i,threshold:s}=n,c=(0,r.useCallback)((e=>{t||a(e.target.value)}),[a,t]),d=(0,r.useCallback)((e=>{t||l(e)}),[l,t]);return i?r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Pill,{flavour:"success",hollow:!0,icon:"reload"},"Recovery Threshold"),r.createElement(o.TextInput,{onChange:c,value:s,type:"number",min:0,size:"tiny",metaShrinked:!0,containerStyles:{width:"80px"},disabled:t}),r.createElement(k.A,{content:"Remove recovery threshold"},r.createElement(o.Button,{type:"button",icon:"trashcan",flavour:"borderless",onClick:()=>d(!1),iconColor:"textLite",iconSize:"small",disabled:t}))):r.createElement(o.Button,{type:"button",label:"Recovery Threshold",icon:"plus",flavour:"borderless",onClick:()=>d(!0),disabled:t})},bl=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{isSimple:t,isComplex:n,operator:l,status:r,value:o,threshold:a}=e;return t?`$this ${l} (${o})`:n?`$this ${l} (($status >= ${r}) ? (${a}) : (${o}))`:""},El=e=>{let{status:t,parsedExpression:n,onChange:l,isDisabled:o}=e;return{onOperatorChange:(0,r.useCallback)((e=>{let{symbol:t}=e;if(!o){const e=bl({...n,operator:t});l(e)}}),[n,l,o]),onValueChange:(0,r.useCallback)((e=>{if(!o){const t=bl({...n,value:e});l(t)}}),[n,l,o]),toggleRecoveryThreshold:(0,r.useCallback)((e=>{if(!o){const r=!e,o=!!e,a=bl({...n,isSimple:r,isComplex:o,status:gl[t],threshold:"70"});l(a)}}),[t,n,l,o]),onChangeThreshold:(0,r.useCallback)((e=>{if(!o){const t=bl({...n,threshold:e});l(t)}}),[n,l,o])}},yl=e=>{let{isDisabled:t,expression:n="",onChange:l}=e;const a=t?"":n,i=(0,r.useCallback)((e=>{t||l(e.target?.value||"")}),[t,l]);return r.createElement(o.Flex,{column:!0,gap:1},r.createElement(o.Text,null,"Formula"),r.createElement(o.Box,{width:"500px"},r.createElement(o.TextInput,{value:a,placeholder:"$this",onChange:i,size:"tiny",disabled:t})))},xl=e=>{let{onDecline:t,onConfirm:n}=e;return r.createElement(o.ConfirmationDialog,{title:"Reset expression",confirmLabel:"Continue",handleConfirm:n,handleDecline:t,message:r.createElement(o.Flex,{gap:2,column:!0},r.createElement(o.TextBig,null,"Your custom expression is going to be reset."),r.createElement(o.TextBig,null,"Are you sure you want to change?"))})},Cl=e=>t=>{const{isSimple:n,isComplex:a}=t.parsedExpression,i=t.value&&!n&&!a,[s,c]=(0,r.useState)(i?1:0),[d,,u,m]=(0,j.A)(),p=(0,r.useCallback)((e=>{"0"==e.target.value?u():c(1)}),[u,c]),g=(0,r.useCallback)((()=>{c(0),m()}),[c,m]),h=(0,r.useMemo)((()=>[{radioButtonValue:0,isDisabled:0!=s,checked:0==s,Component:e},{radioButtonValue:1,isDisabled:1!=s,checked:1==s,Component:yl}]),[s]);return r.createElement(r.Fragment,null,r.createElement(o.Flex,{column:!0,gap:2},h.map((e=>{let{radioButtonValue:n,isDisabled:a,checked:i,Component:s}=e;return r.createElement(o.Flex,{key:n,alignItems:"center",gap:2},r.createElement(o.RadioButton,{value:n,checked:i,onChange:p}),r.createElement(s,(0,l.A)({isDisabled:a},t)))}))),d?r.createElement(xl,{onDecline:m,onConfirm:g}):null)},vl=Cl((e=>{let{isDisabled:t,parsedExpression:n={},options:l={},onChange:a}=e;const{alertStatus:i}=l,{operator:s,value:c,status:d}=n,u=pl[d]||i,{onOperatorChange:m,onValueChange:p,toggleRecoveryThreshold:g,onChangeThreshold:h}=El({status:u,parsedExpression:n,onChange:a,isDisabled:t});return r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Box,null,r.createElement(cl.A,{width:"80px",flavour:u,textSize:"small"},(0,me.Zr)(u,!0))),r.createElement(hl,{value:s,onChange:m,isDisabled:t}),r.createElement(o.TextInput,{onChange:e=>p(e.target.value),value:c,type:"number",disabled:t,min:0,size:"tiny",metaShrinked:!0,containerStyles:{width:"80px"}}),r.createElement(fl,{isDisabled:t,parsedExpression:n,toggleRecoveryThreshold:g,onChangeThreshold:h}))})),kl=e=>{const{alertStatus:t}=e.options,n=(0,r.useMemo)((()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=e.match(dl);if(t)return{isSimple:!0,operator:t[1],value:t[2]};const n=e.match(ul);return n?{isComplex:!0,operator:n[1],statusOperator:n[2],status:n[3],threshold:n[4],value:n[5]}:{}}(e.value)),[e.value]);return t?r.createElement(vl,(0,l.A)({expression:e.value,parsedExpression:n},e)):(console.warn(`${e.id} field is declared to be an alert expression but it does not provide an alert status`),null)},Al=(e,t)=>{const n=parseFloat(e),{multiplier:l}=t||{};return{num:n,multiplier:parseFloat(l)}},wl=e=>{let{value:t=0,onChange:n=p(),scale:l=[],defaultScale:a,min:i=0,step:s=1}=e;const c=l.find((e=>{let{value:t}=e;return t==a}))||l[0],[d,u]=(0,r.useState)(c),m=((e,t)=>{const{num:n,multiplier:l}=Al(e,t);return l&&!isNaN(n)?Math.round(n/l*100)/100:0})(t,d),g=(0,r.useCallback)((e=>{const t=((e,t)=>{const{num:n,multiplier:l}=Al(e,t);return l&&!isNaN(n)?n*l:0})(e.target.value,d);n(t)}),[d,n]);return r.createElement(o.Flex,{gap:2,alignItems:"center"},r.createElement(o.TextInput,{value:m,onChange:g,type:"number",min:i,step:s,size:"small"}),r.createElement(o.Select,{value:d,options:l,onChange:u,styles:{minWidth:"80px",size:"tiny"}}))},Il=[{value:"sec",label:"Seconds",multiplier:1},{value:"min",label:"Minutes",multiplier:60},{value:"hour",label:"Hours",multiplier:3600},{value:"day",label:"Days",multiplier:86400},{value:"week",label:"Weeks",multiplier:604800},{value:"month",label:"Months",multiplier:2592e3},{value:"year",label:"Years",multiplier:31536e3}],Sl=e=>{const{schema:t={}}=e,{type:n}=t,o="number"==n?.1:1,{scales:a}=e.options||{},i=a?Il.filter((e=>{let{value:t}=e;return a.includes(t)})):Il;return r.createElement(wl,(0,l.A)({scale:i,step:o},e))},Fl=e=>r.createElement(Sl,(0,l.A)({},e,{defaultScale:e.options?.scale})),Tl=[{value:"B",label:"Bytes",multiplier:1},{value:"KiB",label:"KiB",multiplier:1024},{value:"MiB",label:"MiB",multiplier:Math.pow(1024,2)},{value:"GiB",label:"GiB",multiplier:Math.pow(1024,3)},{value:"TiB",label:"TiB",multiplier:Math.pow(1024,4)}],Dl=e=>{const{scales:t}=e.options||{},n=t?Tl.filter((e=>{let{value:n}=e;return t.includes(n)})):Tl;return r.createElement(wl,(0,l.A)({scale:n},e))},Bl={TextWidget:Gn,CheckboxWidget:Jn,SelectWidget:Qn,RadioWidget:Xn,TextareaWidget:tl,PasswordWidget:il,URLWidget:sl,alertExpressionWidget:kl,durationWidget:Fl,memorySizeWidget:e=>r.createElement(Dl,(0,l.A)({},e,{defaultScale:e.options?.scale}))};var Pl=n(22086);const Nl=(0,w.default)(Pl.Ay).withConfig({displayName:"styled__StyledForm",componentId:"sc-epjsfn-0"})(["display:flex;flex-direction:column;justify-content:space-between;height:100%;overflow-y:auto;padding-right:8px;"]);var Ml=n(83084),_l=n(81638),Ll=n(30577),Ol=n(93615);const Rl=w.default.div.withConfig({displayName:"styled__StyledTerminalCommand",componentId:"sc-1oflxul-0"})(["display:flex;position:relative;flex-direction:column;color:",";background:",";border:1px solid ",";border-radius:4px;overflow-wrap:anywhere;white-space:",";padding:16px 16px 24px;width:100%;height:100%;font-family:monospace;font-weight:bold;letter-spacing:0.09px;line-height:16px;font-size:12px;word-break:break-word;overflow-y:auto;"],(0,o.getColor)("primary"),(0,o.getColor)("terminalGreen"),(0,o.getColor)("primary"),(e=>{let{wrap:t}=e;return"true"==t?"pre-wrap":"pre"})),jl=(0,w.default)(o.Icon).withConfig({displayName:"styled__StyledIcon",componentId:"sc-1oflxul-1"})(["display:flex;align-self:flex-end;cursor:pointer;position:absolute;bottom:16px;right:16px;"]);var $l=n(46741),zl=n(22292),Hl=n(19673),Vl=n(28061);const Wl={Business:!0,Pro:!0,Homelab:!0,Community:!1},Yl=(0,g.A)(o.Button),Ul=e=>{let{getShouldUpgrade:t,...n}=e;const{value:l}=(0,Hl.JN)(),o=(0,$l.JT)("billing:Manage"),a=(0,Vl.A)(),i=(0,r.useMemo)((()=>"function"==typeof t?t(l):!function(){return Wl[(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).class]}(l)),[t,l]),s=(0,r.useMemo)((()=>i?o?"Upgrade your plan to use this feature":"You don't have sufficient permissions to upgrade the plan":null),[o,i]),c=(0,r.useMemo)((()=>({label:"Upgrade now!",onClick:a,tooltip:s,disabled:!o,noWrapper:!0,...n})),[a,s,o,n]);return i?r.createElement(Yl,c):null},ql=function(){let{getShouldUpgrade:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=(0,zl.uW)("isAnonymous"),o=(0,c.dg)();return n||o?null:r.createElement(Ul,(0,l.A)({getShouldUpgrade:e},t))},Kl=(e,t)=>{if(!e||!t)return e;const n=(e=>Object.entries(e).reduce(((e,t)=>{let[n,l]=t;return[...e,..."password"==l?.["ui:widget"]?[n]:[]]}),[]))(t);if(!n.length)return e;const l=new RegExp(`\\b(${n.join("|")}):\\s*[^ \\n]*`,"gi");return e.replace(l,((e,t)=>`${t}: ****`))};var Gl=n(18682);const Jl=e=>{let{error:t}=e;return r.createElement(o.Flex,{padding:[4]},r.createElement(o.Text,{color:"error"},t))},Zl=e=>r.createElement(o.Flex,(0,l.A)({column:!0,gap:2},e),r.createElement(o.Flex,{gap:2,alignItems:"center"},r.createElement(o.Icon,{color:"warning",name:"warning_triangle"}),r.createElement(o.Text,null,"This feature is only available to paid plans")),r.createElement(ql,{small:!0})),Ql=e=>{let{id:t,node:n,canGetUserConfig:l,onOpenTerminal:a}=e;const{value:i,error:s}=(0,J.MQ)(),{value:c}=(0,J.t8)({id:t,node:n}),d=(0,r.useMemo)((()=>(e=>{if(!e)return e;const t=e.split(/\r?\n/),n=t[0].match(/^\s*/)[0]?.length;return n?t.map((e=>{const t=e.match(/^\s*/)[0]?.length;return e.slice(Math.min(t,n))})).join("\n"):e})(Kl(i,c?.uiSchema))),[i]),{hasPermission:u}=(0,U.j)({edit:!0}),[m,p]=(0,j.A)();return(0,r.useEffect)((()=>{a()}),[]),l?s?r.createElement(Jl,{error:s}):u?r.createElement(o.Flex,{column:!0,width:70,height:"100%",gap:1,alignItems:"start"},r.createElement(o.Checkbox,{label:"Wrap text",checked:m,onChange:p}),r.createElement(Rl,{wrap:m?"true":"false"},d,r.createElement(jl,{name:"copy",size:"small",color:"textLite",onClick:(0,Gl.C)(i,{text:"Config copied to your clipboard."})}))):r.createElement(Zl,null):r.createElement(o.Flex,{padding:[4]},r.createElement(o.Text,null,"Configuration text export is not supported by this node."))},Xl={configuration:{iconName:"gear",color:{active:"success",notActive:"textLite"},width:"14px",Content:Ql,dataTestId:"configurationTab",label:"Config"}},er=["configuration"],tr=e=>{let{id:t,node:n,isOpen:l,toggleIsOpen:o,canGetUserConfig:a,onOpenTerminal:i}=e;const{Content:s}=Xl.configuration;return r.createElement(_l.Ay,{collapsedComponent:r.createElement(Ll.A,{onClickTab:o,availableTabs:Xl,tabsToShow:er}),isOpen:l,header:r.createElement(Ol.A,{isOpen:l,onToggle:o,title:"Configuration",icon:null})},l?r.createElement(s,{id:t,node:n,padding:[0,3,30],canGetUserConfig:a,onOpenTerminal:i}):null)},nr=e=>{let{title:t="Error",children:n,...a}=e;return r.createElement(o.Flex,(0,l.A)({column:!0,gap:2},a),r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Icon,{name:"warning_triangle",color:"errorText"}),r.createElement(o.TextBigger,{color:"errorText"},t)),n)};var lr=n(63314);const rr=function(){let{remainingErrors:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[t,n]=(0,j.A)();return r.createElement(r.Fragment,null,r.createElement(o.Collapsible,{open:t,duration:0},e.map((e=>{let{message:t}=e;return r.createElement(o.Text,{key:t,color:"errorText"},t)}))),r.createElement(o.Flex,{padding:[2,0,0,0]},r.createElement(o.Button,{flavour:"hollow",neutral:!0,small:!0,label:t?"Hide":`Show ${e.length} more`,onClick:n})))},or=function(){let{id:e,errors:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.length?r.createElement(lr.Ay,{feature:"DyncfgForm",id:e,validationErrors:!0},r.createElement(nr,null,r.createElement(o.Flex,{alignItems:"start",column:!0},r.createElement(o.Text,{color:"errorText"},t[0].message),t.length>1?r.createElement(rr,{remainingErrors:t.slice(1)}):null))):null};var ar=n(94177),ir=n(74002),sr=n(20859);const cr={...sr.Ii,Live:{...sr.Ii.Live,head:{...sr.Ii.Live.head,hasML:!1,hasParentNode:!0,hasFn:!1},node:{...sr.Ii.Live.node,showMl:!1,showParentNode:!0,showFn:!1}}},dr=e=>{let{extraKey:t=d.q4}=e;return r.createElement(o.Flex,{column:!0,height:{max:"60vh"}},r.createElement(o.Flex,{flex:"1",overflow:"hidden"},r.createElement(o.Flex,{column:!0,flex:!0},r.createElement(ar.A,{flavour:"dyncfg",extraKey:t,statusProps:cr,testIdPrefix:"node-ids",param:"selectedNodeIds",groupProps:{collapsible:!1,background:"modalBackground",padding:[3],flex:"1",overflow:"hidden"},height:"auto",width:"100%"})),r.createElement(ir.Ay,{flavour:d.q4,basis:60,baseWidth:60,flex:!1,title:"Dynamic filters",help:"Filter your nodes for this page. Count next to each item refer to the number of nodes that will be selected and used across the page.",includedTabs:["filters"],loaded:!0,onClose:()=>{},groupProps:{background:"modalBackground"},background:"modalBackground"})))},ur=(0,w.default)(o.TextBig).withConfig({displayName:"styled__NodeName",componentId:"sc-1dfnbe3-0"})(["font-family:monospace;"]),mr={fulfilled:{text:"Success",color:"primary"},rejected:{text:"Failed",color:"error"},default:{text:"Processing...",color:"text"}},pr=e=>{let{label:t,result:n={}}=e;const{status:l,reason:a}=n,i=a?.response?.data?.errorMessage||a?.message||"Something went wrong...",{text:s,color:c}=(0,r.useMemo)((()=>mr[l]||mr.default),[l]),[d,u]=(0,j.A)(!0);return r.createElement(o.Flex,{column:!0,gap:1},r.createElement(o.Flex,{gap:2,alignItems:"center"},r.createElement(o.TextBig,{color:c},s),r.createElement(ur,null,t),a?r.createElement(o.Icon,{name:"chevron_down",width:"10px",height:"10px",color:"textLite",cursor:"pointer",onClick:u,rotate:d?2:null}):null),a?r.createElement(o.Collapsible,{open:d,padding:[0,0,0,2]},r.createElement(o.Text,{color:"error"},(0,me.Zr)(i))):null)},gr=e=>{let{selectedNodes:t,results:n=[]}=e;return r.createElement(o.Flex,{column:!0,gap:4,padding:[4,0]},n.length?null:r.createElement(o.TextBig,null,"Submitting to multiple nodes..."),r.createElement(o.Flex,{column:!0,gap:3},t.map((e=>{let{value:t,label:l}=e;const o=n.find((e=>{let{nodeId:n}=e;return n==t}));return r.createElement(pr,{key:t,label:l,result:o})}))))};n(9920),n(3949);var hr=n(47444);const fr=e=>{let{id:t,formRef:n,onClose:l,refreshData:o}=e;const i=(0,c.vt)(),{nodes:s}=le(),u=(0,a.a7)({extraKey:d.q4,merge:!1}),m=s.filter((e=>{let{value:t}=e;return u.includes(t)})),{isNewItem:p,setIsDirty:g}=W(),[h,f]=(0,r.useState)([]),[b,E]=(0,r.useState)(),y=(0,J.hp)({id:t,isNewItem:p}),[x,,C,v]=(0,j.A)(),[k,,A]=(0,j.A)(),w=(0,J.Hj)(),[I,S,,F]=(0,ue.A)(),T=(0,r.useCallback)((e=>{l?.(),o?.(),(e||p&&"success"==b)&&w()}),[l,p,w,b,o]),D=(0,hr.Zs)((e=>{let{set:l}=e;return async()=>{const e=n?.current?.state?.formData;f([]),C(),A(),y({nodes:m,payload:e}).then((e=>{g(!1);const n=e.map(((e,t)=>({...e,nodeId:m[t]?.value})));f(n);const r=e.map((e=>{let{status:t}=e;return t}));r.find((e=>"fulfilled"==e))?r.some((e=>"rejected"==e))?(E("partialFail"),F({text:"Some submissions have failed."})):(E("success"),I({text:"All nodes updated successfully."})):(E("fail"),S({text:"All submissions have failed."})),n.forEach((e=>{let{status:n,nodeId:r}=e;"fulfilled"==n&&l((0,J.KD)({spaceId:i,id:t,node:r}),!0)}))})).catch(S).finally((()=>{v()}))}}),[i,n,m,y,C,v,f,g,w,E,S,F,I]);return{selectedNodes:m,onSubmit:D,onCloseButtonClick:T,loading:x,inProcess:k,results:h,submitStatus:b}},br=(0,g.A)(o.Button),Er=e=>{let{id:t,formRef:n,onClose:l,refreshData:a}=e;const{selectedNodes:i,onSubmit:s,onCloseButtonClick:c,loading:d,inProcess:u,results:m,submitStatus:p}=fr({id:t,formRef:n,onClose:l,refreshData:a});return r.createElement(o.Modal,{backdropContainerProps:{zIndex:"120"},backdropProps:{backdropBlur:!0}},r.createElement(o.ModalContent,{width:{min:100,base:200},background:"modalBackground",round:2,overflow:"hidden"},r.createElement(o.ModalHeader,{background:"modalBackground"},r.createElement(o.H4,null,"Select nodes")),r.createElement(o.ModalBody,null,u?r.createElement(gr,{selectedNodes:i,results:m}):r.createElement(dr,null)),r.createElement(o.ModalFooter,{gap:2},r.createElement(br,{type:"button",flavour:"hollow",small:!0,label:"Close",onClick:()=>c(!0),tooltip:"Go to configuration form",disabled:d}),r.createElement(br,{type:"button",label:"Submit",small:!0,onClick:s,tooltip:i.length?null:"Select some nodes",disabled:d||!i.length||!!p}))))},yr=(0,Q.A)(o.Button),xr=e=>{let{id:t,formRef:n,loading:o,refreshData:i}=e;const[s,,c,d]=(0,j.A)(),{state:u}=(0,J.L5)(),{nodeIds:m=[]}=u||{},{node:p}=le(),{isNewItem:g,entityProps:h={}}=W(),{cmds:f=[]}=h,b=g||f.includes("update"),{user_disabled:E}=Fe(),y=It(),x=(0,Vl.A)(),C=(0,zl.uW)("isAnonymous"),v=(0,$l.JT)("billing:Manage"),[,k]=(0,a.Oj)({extraKey:"dyncfg",merge:!1});(0,r.useEffect)((()=>{c&&m.length>1&&k(m)}),[c,m,k]);const A=(0,r.useCallback)((e=>y?b?e||null:"You don't have permissions to save your changes":"Please provide a name first"),[y,b]),w=(0,r.useMemo)((()=>({submit:{label:"Submit",tooltip:A(`Submit your changes to ${p.label} node`),textTransform:""},multiple_submit:{type:"button",flavour:"hollow",label:"Multi-Node Submit",tooltip:A("Submit your changes to another node or to multiple nodes"),onClick:c,textTransform:""},nonPaid:{type:"button",label:"Upgrade",tooltip:"Upgrade your plan to use this feature.",disabled:!v||C,onClick:x,textTransform:""}})),[y,c,b,v,C,x,A]),I=!b||o||E||!y,{hidden:S,isDisabled:F,tooltipText:T,showUpgradeButton:D}=(0,U.j)({edit:!0,tooltip:w.submit.tooltip,disabled:I}),{isDisabled:B,tooltipText:P}=(0,U.j)({edit:!0,tooltip:w.multiple_submit.tooltip,disabled:I});return S?null:D?r.createElement(yr,(0,l.A)({small:!0,disabled:I,isLoading:o},w.nonPaid)):r.createElement(r.Fragment,null,r.createElement(yr,(0,l.A)({small:!0,disabled:B,isLoading:o},w.multiple_submit,{tooltip:P})),r.createElement(yr,(0,l.A)({small:!0,disabled:F,isLoading:o},w.submit,{tooltip:T})),s?r.createElement(Er,{id:t,formRef:n,onClose:d,refreshData:i}):null)},Cr=(0,q.A)(U.A),vr=e=>{let{loading:t}=e;const{node:n}=le(),{id:l,formData:o,entityProps:a={}}=W(),{cmds:i=[]}=a,{user_disabled:s}=Fe(),c=i.includes("test"),d=(0,J.EZ)({id:l,node:n}),u=It({defaultName:"test"}),m=t||s,[p,g]=ge(),h=p({successMessage:"Successfully tested configuration"}),f=g(),b=(0,r.useCallback)((()=>{d({name:u,payload:o}).then(h).catch(f)}),[u,d,o,h,f]);return c?r.createElement(Cr,{edit:!0,feature:"DyncfgItem",payload:{id:l,node:n?.value},label:"Test",small:!0,tooltip:"Test your configuration",flavour:"hollow",onClick:b,disabled:m,type:"button"}):null},kr=((0,Q.A)(o.Button),e=>{let{id:t,formRef:n,loading:l,errors:a=[],openUserConfig:i,refreshData:s}=e;return r.createElement(o.Flex,{background:"modalBackground",position:"sticky",bottom:0,gap:2,padding:[4,0,0,0],alignItems:"baseline",justifyContent:"between",zIndex:10},a.length?r.createElement(or,{id:t,errors:a}):r.createElement(o.Flex,null),r.createElement(o.Flex,{gap:2},null,r.createElement(vr,{loading:l}),r.createElement(xr,{id:t,formRef:n,loading:l,refreshData:s})))}),Ar=function(){let{id:e,error:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="string"==typeof t?{error_message:t}:"object"==typeof t?t:{},l=pe(),a=(0,r.useMemo)((()=>l(n)),[n]);return r.createElement(lr.DL,{feature:"DyncfgForm",id:e,error:JSON.stringify(t)},r.createElement(o.Flex,{column:!0,gap:2},r.createElement(o.Flex,{alignItems:"center",gap:2},r.createElement(o.Icon,{name:"warning_triangle",color:"text"}),r.createElement(o.H3,null,"Error")),r.createElement(o.TextBig,null,a)))},wr=function(){let{id:e,node:t,isNewItem:n,data:l=d.gh,submitMethod:o,setIsDirty:a=p(),setError:i=p()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=(0,r.useRef)(0),c=(0,r.useRef)(),{entityProps:u={}}=W(),{cmds:m=[]}=u,g=m.includes("userconfig"),[h,f,b]=(0,j.A)(g),{isLoading:E,loaded:y,formData:x,setFormData:C,refreshData:v,schema:k,resourcesError:A,errors:w,onChange:I,onSubmit:S,onError:F,getUserConfig:T}=Ft({id:e,node:t,data:l,submitMethod:o,userConfigIsOpen:h,setIsDirty:a,setError:i}),{jsonSchema:D,uiSchema:B}=k||{};(0,r.useEffect)((()=>(s.current=Date.now(),()=>{s.current=0})),[]);const P=(0,r.useCallback)((e=>{const t=Date.now()-s.current,n=0==s.current||t<500;I(e,n)}),[I]),N=(0,r.useCallback)((()=>{setTimeout((()=>{if(s.current>0&&g){const e=c.current?.state?.formData;T(e)}}),50)}),[s.current,c.current,g,T]);return y?A?r.createElement(Ar,{id:e,error:A}):r.createElement(lr.Ay,{feature:"DyncfgForm",id:e,isNewItem:n},r.createElement(Ml.A,{margin:[0,0,2],padding:[2,0,0,0],sidebar:r.createElement(tr,{id:e,node:t,isOpen:h,toggleIsOpen:f,canGetUserConfig:g,onOpenTerminal:N}),containerProps:{id:"dyncfg-form-layout",border:{side:"top",color:"border"}}},r.createElement(Nl,{ref:c,className:"dyncfg-form",disabled:E,schema:D,uiSchema:B,formData:x,formContext:{setFormData:C},templates:qn,widgets:Bl,validator:on.Ay,onError:F,onChange:P,onSubmit:S},r.createElement(kr,{id:e,formRef:c,loading:E,errors:w,openUserConfig:b,refreshData:v})))):r.createElement(Oe.A,{title:"Loading form...",background:"modalBackground"})},Ir=e=>{let{id:t,node:n,renderChildren:l}=e;const{setFormData:o}=W(),{loaded:a,value:i,hasError:s,error:c,refresh:d}=(0,J.SW)({id:t,node:n}),[u,m]=(0,J.Jb)({id:t,node:n});return(0,r.useEffect)((()=>{u&&(d(),m(!1))}),[u,d,m]),(0,r.useEffect)((()=>{a&&!s&&o(i)}),[a,s,o,i]),a?s?r.createElement(Ar,{id:t,error:c}):l({id:t,node:n,data:{loaded:a,value:i,hasError:s,refresh:d}}):null},Sr=e=>{let{formData:t={},renderChildren:n}=e;const{formData:l}=W();return n({data:{...d.gh,value:{...t,...l}}})},Fr=e=>{let{id:t,formData:n,isNewItem:o,...a}=e;const{node:i}=le(),s=(0,J.Nj)({id:t,node:i}),c=(0,J.xS)({id:t,node:i});return o?r.createElement(Sr,{formData:n,renderChildren:e=>r.createElement(wr,(0,l.A)({id:t,node:i,isNewItem:o,submitMethod:s},a,e))}):r.createElement(Ir,{id:t,node:i,renderChildren:e=>r.createElement(wr,(0,l.A)({submitMethod:c},a,e))})},Tr=(0,r.memo)(Fr),Dr=()=>{const{node:e,path:t}=le(),n=(0,J.sh)({node:e,path:t}),{entityProps:o,...a}=n||{};return n?r.createElement(rn,{id:n.template,flavour:"entity",title:`${n.template}:placeholder`,entityProps:{...o,...a},isNewItem:!0,renderChildren:e=>r.createElement(Tr,(0,l.A)({},o,e,{id:n.template,formData:n.formData,isNewItem:!0}))}):null};var Br=n(37618);const Pr=`dyncfg-edit-alet-warning-dismiss-${window.envSettings?.visitor}`,Nr={lineHeight:1.6},Mr=e=>{let{alertName:t,nodeName:n}=e;const l=localStorage.getItem(Pr),[a,,,i]=(0,j.A)(!l),[s,c]=(0,r.useState)(),d=(0,r.useCallback)((e=>{c(e)}),[c]),u=(0,r.useCallback)((()=>{s&&localStorage.setItem(Pr,!0),i()}),[s,i]);return a?r.createElement(o.Modal,{backdropProps:{backdropBlur:!0}},r.createElement(o.ModalContent,null,r.createElement(o.ModalHeader,null,r.createElement(o.H4,null,"Editing Alerts")),r.createElement(o.ModalBody,null,r.createElement(o.Flex,{column:!0,gap:2,width:{max:120}},r.createElement(o.TextBig,Nr,"You are about to edit the alert ",r.createElement(o.TextBig,{color:"primary"},t),n?r.createElement(r.Fragment,null," ","on node ",r.createElement(o.TextBig,{color:"primary"},n)):null,"."),r.createElement(o.TextBig,Nr,'Keep in mind that alerts in Netdata are templates that are applied to all instances of the same kind (e.g. editing a disk alert, means you are changing the alerts for all disks on that node). If you want to overwrite the rules for a single instance, do not change the current rules. Instead add a new rule and select "Apply to a specific instance" for that rule, matching the instance you want to overwrite.'),Br.Ay?r.createElement(o.TextBig,Nr,'To apply an alert on all your currently connected nodes, edit it and select "Submit to Multiple Nodes".'):r.createElement(o.TextBig,Nr,'When having parents and you have connected both parents and children to Netdata Cloud, the alert needs to be altered on both Netdata parents and children, otherwise one of the two will be using the old version. To apply an alert on multiple nodes, edit it and select "Submit to Multiple Nodes".'))),r.createElement(o.ModalFooter,{justifyContent:"between"},r.createElement(o.Flex,{gap:2,alignItems:"center"},r.createElement(o.Checkbox,{checked:s,onChange:d}),r.createElement(o.TextBig,null,"Don't show this again")),r.createElement(o.Button,{type:"button",flavour:"hollow",label:"OK",textTransform:"uppercase",onClick:u})))):null},_r={alertName:{itemTitlePrefix:d.DR,treeEntryKey:d.$7}},Lr=e=>{let{tree:t}=e;const{state:n}=(0,J.L5)(),{alertName:o,nodeId:a}=n||{},s=(0,i.xY)(a,"name"),{itemTitlePrefix:c,treeEntryKey:d}=_r.alertName,u=o?`${c}${o}`:null,m=t&&u?t[d]?.[u]:null;return o?r.createElement(r.Fragment,null,r.createElement(rn,{flavour:"entity",title:u,entityProps:m,isOpen:!0,isEditFromState:!0,renderChildren:e=>r.createElement(Tr,(0,l.A)({id:u},m,e))}),r.createElement(Mr,{alertName:o,nodeName:s})):null};var Or=n(73700),Rr=n(57530),jr=n(51220);const $r=e=>{let{k:t,v:n,rowVirtualizer:o,virtualRow:a,isActiveSticky:i,level:s,rowProps:c,renderChildren:d}=e;const{templateChildren:u,...m}=n||{},p=(0,r.useMemo)((()=>({...(0,F.bn)(m),templateChildren:u})),[m,u]),g=(0,r.useMemo)((()=>({width:"100%",overflow:"hidden",...i&&null!==m.stickyIndex&&!isNaN(m.stickyIndex)?{position:"sticky",top:m.stickyIndex*a.size,zIndex:10}:{position:"absolute",top:0,left:0,transform:`translateY(${a.start}px)`}})),[i,m.stickyIndex]);return o&&a?r.createElement("div",{className:"dyncfg-virtual-row",key:a.key,style:g,ref:o.measureElement,"data-index":a.index,"data-key":t,"data-id":n.id},r.createElement(rn,(0,l.A)({flavour:"path"!=n.type?"entity":n.type,title:t,entityProps:p,level:s,renderChildren:d},c))):null},zr=(0,w.default)(o.Flex).attrs((e=>({width:"100%",height:`${d.FL}px`,position:"absolute",top:0,left:0,alignItems:"center",padding:[0,6,0,12],border:{side:"all",color:"border"},...e}))).withConfig({displayName:"placeholder__StyledPlaceholderContainer",componentId:"sc-1lr4vg8-0"})(["transform:translateY(",");"],(e=>{let{offset:t}=e;return t*d.FL+"px"})),Hr=(0,w.default)(o.Flex).attrs((e=>({width:"100px",height:"10px",round:"5px",...e}))).withConfig({displayName:"placeholder__Shimmer",componentId:"sc-1lr4vg8-1"})(["@keyframes shimmer{to{background-position-x:0%;}}background:linear-gradient( -45deg,"," 40%,"," 50%,"," 60% );background-size:300%;background-position-x:100%;animation:shimmer 1s infinite linear;"],(0,o.getColor)("border"),(0,o.getColor)("generic"),(0,o.getColor)("border")),Vr=e=>{let{index:t,overscan:n=0,isBefore:l}=e;const a=l?t:t+n+1;return r.createElement(zr,{justifyContent:"between",offset:a,"data-testid":"dyncfg-config-iyem-placeholder"},r.createElement(o.Flex,{gap:2},r.createElement(Hr,{width:"30px"}),r.createElement(Hr,{width:"240px"})),r.createElement(o.Flex,{gap:2},r.createElement(Hr,{width:"30px"}),r.createElement(Hr,{width:"30px"})))},Wr=(0,r.memo)(Vr),Yr=e=>{let{entries:t=[],rowHeight:n=d.FL}=e;const o=(0,r.useRef)(),a=(0,r.useRef)(),{node:i,path:s,containerRef:c}=le(),[u,m]=(0,J._F)({node:i,path:s}),{items:p}=(0,J.qK)(),{searchItem:g,testString:h,testProps:f}=x(),b=c.current?.getBoundingClientRect()?.bottom,E=o.current?.getBoundingClientRect()?.top,y=(0,r.useMemo)((()=>b&&E?b-E:500),[b,E]),C=(0,r.useMemo)((()=>{let e=0;return t.reduce(((t,n)=>{if(!h(n)||!f(n)||(n.parents||[]).some((e=>p.includes(e))))return t;const l="path"==n.type;return[...t,{...n,...l?{isSticky:l,stickyIndex:e++}:{}}]}),[]).map(((e,t)=>({...e,index:t})))}),[t,h,f,p,g]),v=(0,r.useMemo)((()=>C.reduce(((e,t)=>{let{isSticky:n,index:l}=t;return[...e,...n?[l]:[]]}),[])),[C]),k=(0,r.useCallback)((e=>(a.current||[]).includes(e)),[a.current]),A=(0,r.useCallback)((e=>{a.current=[...v].filter((t=>e.startIndex+v.indexOf(t)>=t));return[...new Set([...a.current||[],...(0,Rr.vp)(e)])].sort(((e,t)=>e-t))}),[a.current,v]),w=(0,r.useCallback)((()=>n),[n]),I=(0,jr.Te)({count:C.length,getScrollElement:()=>o.current,rangeExtractor:A,enableSmoothScroll:!0,estimateSize:w,overscan:5}),{startIndex:S,endIndex:F}=I.calculateRange()||{},{before:T,after:D}=(0,r.useMemo)((()=>{if(void 0===S||void 0===F)return{before:[],after:[]};const e=C.length;return{before:Array(S).fill().map(((e,t)=>t)),after:Array(e-F-1).fill().map(((e,t)=>t+F))}}),[S,F,C.length,5]),B=(0,r.useCallback)((0,Or.n)(100,(e=>{m(e.target.scrollTop)})),[m]);return(0,r.useEffect)((()=>{o.current&&(o.current.scrollTop=u)}),[]),r.createElement("div",{ref:o,style:{height:`${y}px`,overflow:"auto"},onScroll:B},r.createElement("div",{style:{minHeight:`${I.getTotalSize()}px`,width:"100%",position:"relative"}},T.map((e=>r.createElement(Wr,{key:e,index:e,isBefore:!0}))),I.getVirtualItems().map((e=>{const t=C[e.index],{level:n=1}=t||{},o={..."root"==t.type?{flavour:"path"}:{}};return r.createElement($r,{key:e.key,k:t.id,v:t,rowVirtualizer:I,virtualRow:e,isActiveSticky:k(t.index),level:n,rowProps:o,renderChildren:e=>r.createElement(Tr,(0,l.A)({},t,e))})})),D.map((e=>r.createElement(Wr,{key:e,index:e,overscan:5})))))},Ur=(0,xt.A)((()=>n.e(8773).then(n.bind(n,58773))),"DyncfgStyles"),qr=e=>{let{node:t,nodes:n,path:l,tree:a,list:i,inModal:s}=e;const c=(0,r.useRef)();return r.createElement(re.Provider,{value:{node:t,nodes:n,path:l,inModal:s,containerRef:c}},r.createElement(r.Suspense,{fallback:""},r.createElement(Ur,null)),r.createElement(o.Flex,{column:!0,gap:2,ref:c,width:"100%",padding:[0,2]},r.createElement(Yr,{entries:i}),r.createElement(Dr,null),r.createElement(Lr,{tree:a})))};var Kr=n(98496);const Gr={ErrForbidden:{title:"No permissions",Content:()=>r.createElement(r.Fragment,null,r.createElement(o.Text,null,"You don't have permissions to view the configurations."),r.createElement(o.Text,null,"Please contact the Space administrators if this is unexpected."))},ErrNoConfigurableNodes:{title:"No configurable nodes found",Content:()=>r.createElement(o.Text,null,"We couldn't find any node that can be configured from the UI.")},NoDyncfgComponent:{title:"No Dynamic Configuration available",Content:()=>r.createElement(o.Text,null,"It appears no components that support this feature are currently running.")},default:{title:"Error",Content:()=>r.createElement(r.Fragment,null,r.createElement(o.Text,null,"Something went wrong, please check again later."),r.createElement(o.Text,null,"If the problem persists feel free to contact us with a"," ",r.createElement(D.A,{href:"https://github.com/netdata/netdata-cloud/issues/new/choose",target:"_blank",rel:"noopener noreferrer"},"ticket")))}},Jr=function(){let{error:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{errorMsgKey:t}=e||{},{title:n,Content:l}=Gr[t]||Gr.default;return r.createElement(lr.DL,{feature:"DyncfgMainTabs",errorMsgKey:t},r.createElement(Kr.A,{title:n},r.createElement(o.Flex,{column:!0,gap:1},r.createElement(l,null))))},Zr=e=>{let{node:t}=e;const n=(0,r.useRef)(),{state:l}=(0,J.L5)(),{isAlert:o}=l||{},{loaded:a,value:i,hasError:s}=(0,J.wd)({node:t}),c=(0,r.useMemo)((()=>a&&i&&!s?Object.keys(i.tree||{}).reduce(((e,t)=>{t.startsWith("/")||(t=`/${t}`);const n=t.match(/\/[^/]+/g);if(n.length){const t=n[0],l=(0,me.Zr)(t.replace(/^\/?/,""));e.find((e=>e.value==t))||e.push({value:t,label:l})}return e}),[]):null),[a,i?.tree,s]),d=(0,r.useMemo)((()=>a&&(!!c||s)),[a,c,s]),[u,m]=(0,r.useState)(0);return(0,r.useEffect)((()=>{if(c?.length&&o&&!n.current){const e=c.map((e=>{let{value:t}=e;return t})).indexOf("/health");m(e),n.current=!0}}),[o,c,m,n.current]),{loaded:d,tabs:c||[],selectedTab:u,setSelectedTab:m}},Qr=e=>{let{flavour:t,inModal:n,selectedNode:l,setNode:a,options:i}=e;const{loaded:s,tabs:c,selectedTab:d,setSelectedTab:u}=Zr({node:l}),{reset:m}=(0,J.qK)(),[p,g]=(0,r.useState)(0),{loaded:h,value:f,hasError:E,error:y}=(0,J.wd)({node:l,path:c?.[d]?.value}),{tree:x}=f||{},k=(0,r.useMemo)((()=>(0,X.m8)(x)),[x]),{tabs:A,tree:w}=(0,r.useMemo)((()=>(0,X.sr)(k)),[k]),I=w[A[p]],S=(0,r.useMemo)((()=>(0,X.Xt)({tree:I})),[I]),F=(0,r.useMemo)((()=>({height:"100%",padding:[4,0],overflow:{vertical:"auto"}})),[t]),T=(0,r.useCallback)((e=>{m(),u(e),g(0)}),[u,g,m]);return i.length?r.createElement(C,null,r.createElement(o.Flex,{column:!0,height:"100%",gap:4},r.createElement(o.Flex,{alignItems:"end",justifyContent:"between"},r.createElement(o.Flex,{alignItems:"end",gap:4},r.createElement(b,{node:l,setNode:a,options:i}),r.createElement(v,null),r.createElement(bt,{node:l,path:c[d]?.value,list:S})),r.createElement(o.Flex,{alignItems:"center",gap:3},r.createElement(z,{tree:x}),r.createElement(yt,null))),s?c.length?r.createElement(o.Tabs,{height:"100%",selected:d,onChange:T,tabsProps:{border:{side:"bottom",color:"border"}}},c.map((e=>{let{label:t,value:a}=e;return r.createElement(o.Tab,{key:a,label:t},r.createElement(o.Tabs,{height:"100%",selected:p,onChange:g,tabsProps:{border:{side:"bottom",color:"border"}}},A.map((e=>r.createElement(o.Tab,{key:e,label:e,small:!0},r.createElement(o.Flex,F,h?E?r.createElement(Jr,{error:y}):r.createElement(qr,{key:JSON.stringify({value:a,selectedNode:l}),node:l,nodes:i,path:a,tree:x,list:S,inModal:n}):r.createElement(Oe.A,{height:"100%",title:"Loading..."})))))))}))):r.createElement(Jr,{error:{errorMsgKey:"NoDyncfgComponent"}}):r.createElement(Oe.A,{height:"100%",title:"Loading..."}))):r.createElement(o.TextBigger,null,"There are no available nodes.")},Xr=(0,r.memo)(Qr);var eo=n(20378),to=n(78459),no=n(15255),lo=n(68741),ro=n(40982);const oo=e=>{let{message:t,title:n,footer:a,...i}=e;const s=i?.["data-testid"]||"dyncfgError";return r.createElement(o.Flex,(0,l.A)({alignItems:"center",column:!0,"data-testid":s,flex:!0,gap:3,justifyContent:"center",padding:[0,20]},i),r.createElement(o.H3,{"data-testid":`${s}-title`},n),r.createElement(o.TextBig,{color:"textDescription","data-testid":`${s}-message`},t),a)},ao=e=>{let{flavour:t,inModal:n,node:l,nodes:o}=e;const{options:a,node:i,setNode:s}=u({selectedNode:l,nodes:o});return a.length?r.createElement(Xr,{flavour:t,inModal:n,selectedNode:i,setNode:s,options:a}):r.createElement(Jr,{error:{errorMsgKey:"ErrNoConfigurableNodes"}})},io=e=>{const t=(0,a.eO)({extraKey:"nodesView",merge:!1,scoped:!0,roomSlug:e.isVirtual?Br.Iy:null});return r.createElement(ao,(0,l.A)({},e,{nodes:t}))},so=e=>{const{nodes:t}=(0,s.A)({polling:!1});return r.createElement(ao,(0,l.A)({},e,{nodes:t}))},co=e=>{const t=(0,to.OS)();return r.createElement(o.Button,(0,l.A)({label:"Get a fresh agent token",onClick:t},e))},uo="Configurations expose sensitive information about your systems and applications. To protect your privacy, Netdata exposes this information only to logged-in users and claimed agents. When viewing Configurations directly on a Netdata Agent UI, this information is sent directly from the Netdata Agent to your web browser, without exposing it to any third parties.",mo={notLoggedIn:{title:"Sign in to Netdata to use Configurations",description:uo,footer:r.createElement(lo.default,null)},notClaimed:{title:"Connect this agent to Netdata to use Configurations",description:uo,footer:r.createElement(ro.A,null)},noAccess:{title:"This agent belongs to a Netdata Space you are not member of",description:uo,footer:r.createElement(o.TextBig,{color:"textDescription"},"Ask for an invitation from the administrators of the Netdata Space of the agent to use configurations.")},bearerError:{title:"You are not authorized to use Configurations",description:uo,footer:r.createElement(co,null)}},po=e=>{let{flavour:t="settings",node:n,inModal:o}=e;const a=(0,c.dg)(),{state:s}=(0,J.L5)(),{nodeId:d}=s||{},u=(0,i.xY)(d),m={flavour:t,node:d?u:n,inModal:o},[p]=(0,eo.Q8)(),[{bearerProtection:g,error:h}]=(0,to.f7)(),[{canBeClaimed:f,cloudStatus:b}]=(0,no.RJ)();if(a&&h&&g){const{title:e,description:t,footer:n}=(e=>{let{userStatus:t,userNodeStatus:n,accessError:l,canBeClaimed:r}=e;return mo[t]?mo[t]:l?mo.notLoggedIn:r?mo.notClaimed:mo[n]?mo[n]:mo.bearerError})({...p,bearerError:h,canBeClaimed:f,cloudStatus:b});return r.createElement(oo,{title:e,message:t,footer:n})}return a?r.createElement(io,(0,l.A)({isVirtual:a},m)):r.createElement(so,m)}}}]);